var chart,DP_PopupID,DP_PopupAxisObj,DP_PopupAxisPos,DP_Theme_Setting,H2_version="v6.3",H2_server=location.hostname,H2_port=""===location.port?"80":location.port,H2_refreshSec=60,cntrlIsPressed=!1,filter_feld="",DP_point=[],DP_settings={},DP_settings_old={},DP_ApiKey="",DP_DataPointFilter=0,Zeitraum_Ende=new Date(Date.now()),Zeitraum_Start=new Date(Zeitraum_Ende-new Date(864e5)),Scroll_Legend=!0,DP_Legend=1,DP_Navigator=0,DP_Labels=0,DP_Grid=2,DP_DayLight=1,DP_Limit=!1,DP_AutoRefresh=0,DP_ShowFilter=1,AutoRefreshCount=0,DP_attribute=[],DP_Theme="standard",DP_FontSize=14,DP_FontSizes=[8,10,12,14,16,18,20,24,30,40,50,60,70,80,100],DP_DashType=["Solid","Dash","DashDot","Dot","LongDash","LongDashDot","LongDashDotDot","ShortDash","ShortDashDot","ShortDashDotDot","ShortDot"],DP_Queue=[],DP_ColorNext=0,DP_Title="",DP_Subtitle="",DP_Loading=0,DP_Button_Jump=!1,DP_Drag_Pos=0,DP_Zoom=-1,DP_yAxis=[{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText0,color:1,type:0},{position:!1,limit:1,min:10,max:30,tick:11,text:window.ChhLanguage.default.historian.yaxisText1,color:1,type:0},{position:!0,limit:1,min:-20,max:50,tick:11,text:window.ChhLanguage.default.historian.yaxisText2,color:1,type:0},{position:!1,limit:1,min:20,max:90,tick:11,text:window.ChhLanguage.default.historian.yaxisText3,color:1,type:0},{position:!0,limit:1,min:0,max:100,tick:11,text:window.ChhLanguage.default.historian.yaxisText4,color:1,type:0},{position:!0,limit:1,min:0,max:2,tick:11,text:window.ChhLanguage.default.historian.yaxisText5,color:1,type:0},{position:!0,limit:1,min:20,max:100,tick:11,text:window.ChhLanguage.default.historian.yaxisText6,color:1,type:0},{position:!1,limit:1,min:900,max:1e3,tick:11,text:window.ChhLanguage.default.historian.yaxisText7,color:1,type:0},{position:!1,limit:1,min:0,max:5e3,tick:11,text:window.ChhLanguage.default.historian.yaxisText8,color:1,type:0},{position:!0,limit:1,min:300,max:3e3,tick:11,text:window.ChhLanguage.default.historian.yaxisText9,color:1,type:0},{position:!0,limit:1,min:3,max:15,tick:11,text:window.ChhLanguage.default.historian.yaxisText10,color:1,type:0},{position:!0,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText11,color:1,type:0},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText12,color:1,type:1},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText13,color:1,type:0},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText14,color:1,type:0},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText15,color:1,type:0},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText16,color:1,type:0},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText17,color:1,type:0},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText18,color:1,type:0},{position:!1,limit:0,min:0,max:0,tick:11,text:window.ChhLanguage.default.historian.yaxisText19,color:1,type:0}],DP_yAxis_default=JSON.parse(JSON.stringify(DP_yAxis));function createChart(){let t=DP_Theme;"standard"===t&&(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"standard-dark":"standard-light"),DP_Theme_Setting="standard-light"!==t&&window.DP_Themes[t]&&window.DP_Themes["standard-light"]?window.Highcharts.merge(window.DP_Themes["standard-light"],window.DP_Themes[t]):window.DP_Themes["standard-light"],chartSetFontSize(),window.Highcharts.setOptions(DP_Theme_Setting),chartSetOptions(),chartSetElements()}function defaultAttrib(t,e,i){var n={id:i,aggr:"A0",atime:"T1",yaxis:"Y0",comp:"C0",line:"L0",mark:"M0",color:"F0",visible:0,dash:"D0",width:"W2",stack:0,factor:1,offset:0,unit:"",shortname:"",buffer_data:{timestamps:[],values:[],buffer_start:0,buffer_end:0}};if(-1===e?(n.color="F"+DP_ColorNext%chart.options.colors.length,DP_ColorNext++):n.color="F"+e%chart.options.colors.length,-1!==t){switch(n.unit=t.attributes.unit,t.id.identifier){case"ABS_HUMIDITY":n.yaxis="Y10";break;case"HUMIDITY":case"HUMIDITYF":case"ACTUAL_HUMIDITY":case"HUM_MAX_24H":case"HUM_MIN_24H":n.yaxis="Y6";break;case"TEMPERATURE":case"ACTUAL_TEMPERATURE":case"ABS_HUMIDITY":case"DEW_POINT":case"TEMP_MAX_24H":case"TEMP_MIN_24H":n.yaxis="Y1";break;case"SET_TEMPERATURE":case"SETPOINT":case"SET_POINT_TEMPERATURE":n.yaxis="Y1",n.line="L2";break;case"MEAN5MINUTES":n.yaxis="Y3";break;case"BRIGHTNESS":n.yaxis="Y8";break;case"LEVEL":n.yaxis="Y4",n.line="L2",n.unit="";break;case"STATE":n.yaxis="Y5",n.line="L2";break;case"PRESS_SHORT":case"PRESS_LONG":case"PRESS_OPEN":case"MOTION":n.yaxis="Y5",n.mark="M1",n.factor=5,n.line="L5";break;case"VALVE_STATE":n.yaxis="Y4",n.line="L2",n.unit="%"}if("BOOL"===t.attributes.type&&(n.yaxis="Y5",n.line="L2"),"%"===t.attributes.unit&&(n.yaxis="Y4",n.line="L2",n.unit="%"),"SysVar"===t.id.interfaceId&&"°C"===t.attributes.unit&&(n.yaxis="Y1",n.line="L0"),t.attributes.custom&&t.attributes.custom.HighChart){t=t.attributes.custom.HighChart.split("|");if(0<t.length)for(var a of t)if("A"===a.substr(0,1))n.aggr=a;else if("Y"===a.substr(0,1))n.yaxis=a;else if("T"===a.substr(0,1))n.atime=a;else if("F"===a.substr(0,1))n.color=a;else if("C"===a.substr(0,1))n.comp=a;else if("L"===a.substr(0,1))n.line=a;else if("M"===a.substr(0,1))n.mark=a;else if("D"===a.substr(0,1))n.dash=a;else if("W"===a.substr(0,1))n.width=a;else if("V"===a.substr(0,1))n.visible=parseInt(a.substr(1,1));else if("S"===a.substr(0,1))n.stack=parseInt(a.substr(1,2));else if("U"===a.substr(0,1))try{n.unit=decodeURIComponent(a.substr(1,20))}catch(t){n.unit=a.substr(1,20)}else if("N"===a.substr(0,1))try{n.shortname=decodeURIComponent(a.substr(1,40))}catch(t){n.shortname=a.substr(1,40)}else"X"===a.substr(0,1)?n.factor=parseFloat(a.substr(1,10)):"O"===a.substr(0,1)&&(n.offset=parseFloat(a.substr(1,10)))}}return n}function addSerie(t,e){var i,n,a,o,r,s,l,u,d,c,g,h,m,p=void 0,D=t.id.identifier,_=1,f=""===e?t.idx.toString():e+"_"+t.idx.toString(),P=DP_attribute.findIndex(t=>t.id===f);switch(-1===P&&(DP_attribute.push(defaultAttrib(t,-1,f)),P=DP_attribute.findIndex(t=>t.id===f)),a=parseInt(DP_attribute[P].yaxis.substr(1,2)),l=chart.options.colors[parseInt(DP_attribute[P].color.substr(1,2))],u=parseInt(DP_attribute[P].aggr.substr(1,2)),d=parseInt(DP_attribute[P].atime.substr(1,2)),b=parseInt(DP_attribute[P].line.substr(1,2)),o=DP_attribute[P].visible,i=DP_attribute[P].unit,n=DP_attribute[P].shortname,c=DP_attribute[P].stack,g=DP_DashType[parseInt(DP_attribute[P].dash.substr(1,2))],h=parseInt(DP_attribute[P].width.substr(1,2)),m=defineMarker(parseInt(DP_attribute[P].mark.substr(1,2)),l,h),D){case"MEAN5MINUTES":_=3;break;case"STATE":case"VALVE_STATE":_=0}"BOOL"===t.attributes.type&&(_=0),"%"===t.attributes.unit&&(_=0),"SysVar"===t.id.interfaceId&&"°C"===t.attributes.unit&&(_=1),0===b?(r="spline",s=""):1===b?(r="line",s=""):2===b?(r="line",s="left"):3===b?(r="line",s="center"):4===b?(r="line",s="right"):5===b?(r="scatter",s=""):6===b?(r="areaspline",s=""):7===b?(r="area",s=""):8===b?(r="area",s="left"):9===b?(r="area",s="center"):10===b?(r="area",s="right"):11===b&&(r="column",s="");var P=[],D=!1,b=2;0===d?(b=50,P=null):1===d?(D=!0,b=50,P=[["minute",[15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",[1]]]):2===d?P=[["hour",[1]],["day",[1]],["month",[1]],["year",[1]]]:3===d?(P=[["hour",[1]]],D=!0):4===d?(P=[["day",[1]]],D=!0):5===d?(P=[["week",[1]]],D=!0):6===d?(P=[["month",[1]]],D=!0):7===d?(P=[["month",[3]]],D=!0):8===d?(P=[["year",[1]]],D=!0):9===d?(P=[["hour",[3]]],D=!0):10===d?(P=[["hour",[6]]],D=!0):11===d?(P=[["hour",[8]]],D=!0):12===d&&(P=[["hour",[12]]],D=!0),1===u?p={enabled:!0,approximation:"average",forced:D,smoothed:!1,groupPixelWidth:b,units:P}:2===u||4===u||5===u||7===u?p={enabled:!0,approximation:"sum",forced:D,smoothed:!1,groupPixelWidth:b,units:P}:3===u?(p={enabled:!0,approximation:"average",forced:D,smoothed:!1,groupPixelWidth:b,units:P},r="line"===r?"spline":r):p={enabled:!1};b=null,P="",b=function(){return toolTipInfo(this)},P=""!==n?n:"C"===e.substr(0,1)?"SysVar"===t.id.interfaceId?t.attributes.displayName:t.attributes.displayName+"."+t.id.identifier+"("+window.ChhLanguage.default.historian["comptype"+e]+")":"SysVar"===t.id.interfaceId?t.attributes.displayName:t.attributes.displayName+"."+t.id.identifier,p={id:f,name:P,type:r,step:s,yAxis:a,marker:m,visible:2===o,color:l,dashStyle:g,lineWidth:h,fillOpacity:.4,borderColor:l,borderWidth:2,stacking:0===c?null:"normal",stack:0===c?null:"group"+c,data:[],tooltip:{valueDecimals:_,pointFormat:null,pointFormatter:b,valueSuffix:" "+i},dataGrouping:p,dataLabels:defineDataLabels()};chart.addSeries(p,!1,!1)}function defineDataLabels(){var t;return 0===DP_Labels?t={enabled:!1}:1===DP_Labels?t={enabled:!0,allowOverlap:!0,color:null,style:{color:null},formatter:function(){let t;return 0<this.series.data.length?t=this.series.data[this.series.data.length-1]:0<this.series.points.length&&(t=this.series.points[this.series.points.length-1]),t&&t.category&&this.point.category===t.category?this.series.name:""}}:2===DP_Labels&&(t={enabled:!0,allowOverlap:!1,color:null,style:{color:null},formatter:function(){return window.Highcharts.numberFormat(this.y,1)}}),t}function defineMarker(t,e,i){var n={enabled:!1,states:{hover:{enabled:!0}}},i=i<3?4:4+i-2;return 0<t&&t<=chart.options.symbols.length?n={enabled:!0,symbol:chart.options.symbols[t-1],radius:i,lineColor:e,lineWidth:0,fillColor:e}:t>chart.options.symbols.length&&t<=2*chart.options.symbols.length?n={enabled:!0,symbol:chart.options.symbols[t-1-chart.options.symbols.length],radius:i,lineColor:"black",lineWidth:1,fillColor:e}:t>2*chart.options.symbols.length&&t<=3*chart.options.symbols.length?n={enabled:!0,symbol:chart.options.symbols[t-1-2*chart.options.symbols.length],radius:i,lineColor:"white",lineWidth:1,fillColor:e}:t>3*chart.options.symbols.length&&t<=4*chart.options.symbols.length?n={enabled:!0,symbol:chart.options.symbols[t-1-3*chart.options.symbols.length],radius:i,lineColor:e,lineWidth:2,fillColor:"black"}:t>4*chart.options.symbols.length&&t<=5*chart.options.symbols.length&&(n={enabled:!0,symbol:chart.options.symbols[t-1-4*chart.options.symbols.length],radius:i,lineColor:e,lineWidth:2,fillColor:"white"}),n}function setData(t){var e=Zeitraum_Start.getTime(),i=Zeitraum_Ende.getTime();if("MinMax"!==t.options.name){var n="C"===t.options.id.toString().substr(0,1)?t.options.id.toString().split("_")[1]:t.options.id.toString(),a=!1,o=DP_attribute.findIndex(t=>t.id===n);if(-1!==o){if("C0"!==DP_attribute[o].comp){if("C"===t.options.id.toString().substr(0,1)&&2===DP_attribute[o].visible)return;e+=getComparisionBackDay(DP_attribute[o].comp),"C"===t.options.id.toString().substr(0,1)&&(i+=getComparisionBackDay(DP_attribute[o].comp))}DP_attribute[o].buffer_data&&DP_attribute[o].buffer_data.buffer_start&&DP_attribute[o].buffer_data.buffer_end&&(DP_attribute[o].buffer_data.buffer_start<=e&&DP_attribute[o].buffer_data.buffer_end>=i?(a=!0,setSerienData(o,t)):DP_attribute[o].buffer_data.buffer_start>e&&DP_attribute[o].buffer_data.buffer_start<=i&&DP_attribute[o].buffer_data.buffer_end>=i&&0<DP_attribute[o].buffer_data.values.length?i=DP_attribute[o].buffer_data.buffer_start:DP_attribute[o].buffer_data.buffer_start<=e&&DP_attribute[o].buffer_data.buffer_end>=e&&DP_attribute[o].buffer_data.buffer_end<i&&0<DP_attribute[o].buffer_data.values.length&&(e=DP_attribute[o].buffer_data.buffer_end)),a||getDataH2(t,DP_attribute[o].id,o,e,i)}}}function bufferSerienData(e,t){if(e){var i=DP_Queue.findIndex(t=>t[0]===e),n=DP_Queue[i][3];if(0<t.values.length){for(var a=0;a<t.values.length;a++)t.values[a]=Math.round(1e3*t.values[a])/1e3;DP_attribute[n].buffer_data.buffer_start>=DP_Queue[i][4]&&DP_attribute[n].buffer_data.buffer_start===DP_Queue[i][5]&&0<DP_attribute[n].buffer_data.values.length?(DP_attribute[n].buffer_data.buffer_start=DP_Queue[i][4],DP_attribute[n].buffer_data.timestamps=t.timestamps.concat(DP_attribute[n].buffer_data.timestamps),DP_attribute[n].buffer_data.values=t.values.concat(DP_attribute[n].buffer_data.values)):DP_attribute[n].buffer_data.buffer_end<=DP_Queue[i][5]&&DP_attribute[n].buffer_data.buffer_end===DP_Queue[i][4]&&0<DP_attribute[n].buffer_data.values.length?(DP_attribute[n].buffer_data.buffer_end=DP_Queue[i][5],DP_attribute[n].buffer_data.timestamps=DP_attribute[n].buffer_data.timestamps.concat(t.timestamps),DP_attribute[n].buffer_data.values=DP_attribute[n].buffer_data.values.concat(t.values)):(DP_attribute[n].buffer_data.buffer_start=DP_Queue[i][4],DP_attribute[n].buffer_data.buffer_end=DP_Queue[i][5],DP_attribute[n].buffer_data.timestamps=t.timestamps,DP_attribute[n].buffer_data.values=t.values),document.getElementById("count_val").innerHTML=DP_Navigator<3?(Number(document.getElementById("count_val").innerHTML)+t.values.length).toString():""}var o=DP_Queue[i][2];DP_Queue.splice(i,1),loadingInfo(),setSerienData(n,o),loadingInfo()}else console.log("ID missing")}function setSerienData(e,i){let t=parseInt(DP_attribute[e].aggr.substr(1,2));var n,a=DP_attribute[e].comp;let o=Zeitraum_Start.getTime(),r=Zeitraum_Ende.getTime(),s=[],l=0;void 0!==i.options&&"MinMax"!==i.options.name&&("C"===i.options.id.toString().substr(0,1)&&(l=getComparisionBackDay(a),o+=l,r+=l,(n=DP_attribute.findIndex(t=>t.id===i.options.id.toString()))&&(t=parseInt(DP_attribute[n].aggr.substr(1,2)))),s=(0===t?setSerienDataAggr0:2===t?setSerienDataAggr2:5===t?setSerienDataAggr5:6===t?setSerienDataAggr6:7===t?setSerienDataAggr7:setSerienDataAggr1)(e,o,r,l),i.setData(s,!0,!1,!1),3===t&&addAggregationMinMax(i),loadNewAxisInfo(),showAggrText(),"C0"!==DP_attribute[e].comp&&"C"!==i.options.id.toString().substr(0,1)&&(a=chart.get(DP_attribute[e].comp+"_"+DP_attribute[e].id),n=DP_attribute.findIndex(t=>t.id===DP_attribute[e].comp+"_"+DP_attribute[e].id),a&&-1!==n&&"C0"===DP_attribute[n].comp&&2===DP_attribute[n].visible&&setSerienData(e,a)))}function setSerienDataAggr0(e,t,i,n){let a=[];var o=DP_attribute[e].buffer_data,r=sortedIndex(o.timestamps,t),s=sortedIndex(o.timestamps,i);if(t<=o.timestamps[s]){0<r&&t!==o.timestamps[r]&&a.push([t-n,o.values[r-1]*DP_attribute[e].factor+DP_attribute[e].offset]);for(let t=r;t<=s;t++)a.push([o.timestamps[t]-n,o.values[t]*DP_attribute[e].factor+DP_attribute[e].offset])}return a}function setSerienDataAggr1(t,a,e,o){let r=[];var s=DP_attribute[t].buffer_data,a=sortedIndex(s.timestamps,a),l=sortedIndex(s.timestamps,e);if(a<s.timestamps.length){let i=s.values[a],n=s.timestamps[a];for(let e=a;e<=l;e++){if(6e5<s.timestamps[e]-n){n=6e4*Math.round((n+6e5)/6e4);for(let t=n;t<s.timestamps[e]-3e5;t+=6e5)r.push([t-o,i])}i=s.values[e]*DP_attribute[t].factor+DP_attribute[t].offset,n=s.timestamps[e],r.push([s.timestamps[e]-o,i])}}return r}function setSerienDataAggr2(n,a,o,r){let s=[];var l=DP_attribute[n].buffer_data,u=sortedIndex(l.timestamps,a),d=sortedIndex(l.timestamps,o);if(u<l.timestamps.length){let t=l.values[u],i=l.timestamps[u];for(let e=u+1;e<=d;e++)if(l.timestamps[e]>=a&&l.timestamps[e]<=o){if(6e5<l.timestamps[e]-i){i=6e4*Math.round((i+6e5)/6e4);for(let t=i;t<l.timestamps[e];t+=6e5)s.push([t,0])}s.push([l.timestamps[e]-r,(l.values[e]-t)*DP_attribute[n].factor+DP_attribute[n].offset]),t=l.values[e],i=l.timestamps[e]}}return s}function setSerienDataAggr5(n,a,t,o){let r=[],s=0;var l=DP_attribute[n].buffer_data,a=sortedIndex(l.timestamps,a),u=sortedIndex(l.timestamps,t);if(a<l.timestamps.length){let e=0<l.values[a]?1:0,i=l.timestamps[a];for(let t=a+1;t<=u;t++)if(0<e&&0===l.values[t]){if(e=l.timestamps[t]-i,s=i,6e4<e)for(s=i;s<l.timestamps[t]-6e4;s+=6e4)r.push([s-o,+DP_attribute[n].factor+DP_attribute[n].offset]),e-=6e4;0<e&&r.push([s-1-o,Math.round(e/60)/1e3*DP_attribute[n].factor+DP_attribute[n].offset]),e=0,i=l.timestamps[t]}else if(0===e&&0<l.values[t]){if(e=l.timestamps[t]-i,6e4<e)for(s=i;s<l.timestamps[t]-6e4;s+=6e4)r.push([s-o,0]),e-=6e4;e=1,i=l.timestamps[t]}if(0<e){if(e=t-i,6e4<e)for(s=i;s<t-6e4;s+=6e4)r.push([s-o,+DP_attribute[n].factor+DP_attribute[n].offset]),e-=6e4;0<e&&r.push([t-o,Math.round(e/60)/1e3*DP_attribute[n].factor+DP_attribute[n].offset])}}return r}function setSerienDataAggr6(e,t,i,n){let a=[];var o=DP_attribute[e].buffer_data,r=sortedIndex(o.timestamps,t),s=sortedIndex(o.timestamps,i);if(t<=o.timestamps[s])for(let t=r;t<=s;t++){var l=6e4*Math.round((o.timestamps[t]-n)/6e4);a.push([l,o.values[t]*DP_attribute[e].factor+DP_attribute[e].offset])}return a}function setSerienDataAggr7(n,a,o,r){var s=[],l=DP_attribute[n].buffer_data,u=sortedIndex(l.timestamps,a),d=sortedIndex(l.timestamps,o);if(u<l.timestamps.length){let t=l.values[u],i=l.timestamps[u];for(let e=u+1;e<=d;e++)if(l.timestamps[e]>=a&&l.timestamps[e]<=o){if(6e5<l.timestamps[e]-i){i=6e4*Math.round((i+6e5)/6e4);for(let t=i;t<l.timestamps[e];t+=6e5)s.push([t,0])}var c=(l.values[e]-t)*DP_attribute[n].factor+DP_attribute[n].offset;0<=c&&s.push([l.timestamps[e]-r,c]),t=l.values[e],i=l.timestamps[e]}}return s}function sortedIndex(t,e){let i=0,n=t.length-1,a;if(t[i]>=e)return 0;if(t[n]<=e)return n;for(;i<n;)t[a=Math.floor((i+n)/2)]<e?i=a+1:n=a;return i>t.length-1&&(i=t.length-1),i}function getDataH2(t,e,i,n,a){var o,r;"MinMax"!==t.options.name&&(o=e+"_"+Date.now(),r=t.options.id.toString(),"C"===t.options.id.toString().substr(0,1)&&(r=r.split("_")[1]),DP_Queue.push([o,e,t,i,n,a]),loadingInfo(),i="http://"+H2_server+":"+H2_port,i+="/query/jsonrpc.gy",i+=""===DP_ApiKey?"":"?"+DP_ApiKey,a={id:o,method:"getTimeSeriesRaw",params:[r,n,a]},a=JSON.stringify(a),$.ajax({url:i,dataType:"json",contentType:"application/json",type:"post",data:a,cache:!1,async:!0,error:function(t,e,i){ajaxErrorOutput(t,e,i)},success:function(t){t.result?t.result&&bufferSerienData(t.id,t.result):console.log(t)}}))}function requestInitData(){DP_Navigator<3?(document.getElementById("count_val").innerHTML="0",document.getElementById("count_text").innerHTML=window.ChhLanguage.default.historian.labelValues):(document.getElementById("count_val").innerHTML="",document.getElementById("count_text").innerHTML=""),chart=$("#container").highcharts();var t=getLocalData("DataPoints");if(t){try{DP_point=JSON.parse(t)}catch{DP_point={}}DP_point[1]&&DP_point[1].attributes?(parseDataPoints(),(null===(t=getLocalData("DataPointsTime"))||parseInt(t)+36e5<=Date.now())&&setTimeout(requestData,2e3)):requestData()}else requestData();chart.stockTools&&chart.stockTools.showhideBtn.click()}function requestData(){var t="http://"+H2_server+":"+H2_port;t+="/query/jsonrpc.gy",t+=""===DP_ApiKey?"":"?"+DP_ApiKey;var e={id:"DP",method:"getDataPoint",params:[]},e=JSON.stringify(e);$.ajax({url:t,dataType:"json",contentType:"application/json",type:"post",data:e,cache:!1,async:!0,error:function(t,e,i){ajaxErrorOutput(t,e,i)},success:function(t){requestData2(t)}})}function requestSettings(){var t="http://"+H2_server+":"+H2_port;t+="/query/jsonrpc.gy",t+=""===DP_ApiKey?"":"?"+DP_ApiKey;var e={id:"Setup",method:"getConfig",params:["HighChart"]},e=JSON.stringify(e);$.ajax({url:t,dataType:"json",contentType:"application/json",type:"post",data:e,cache:!1,async:!0,error:function(t,e,i){ajaxErrorOutput(t,e,i)},success:function(t){let e;if(t.result)try{e=t.result.replace(/'/g,'"'),e&&'{"'===e.substring(0,2)?(DP_settings=JSON.parse(e),DP_settings_old=JSON.parse(e)):(DP_settings={Setting:""},e=JSON.stringify(DP_settings))}catch(t){DP_settings={Setting:""},e=JSON.stringify(DP_settings)}else DP_settings={Setting:""},e=JSON.stringify(DP_settings);e!==getLocalData("setting")&&(setLocalData("setting",e),parseSetting(),readLinkData()),setLocalData("settingTime",Date.now())}})}function parseSetting(){var t;if(DP_settings){for(t=0;t<DP_yAxis.length;t++)if(DP_settings["YAXIS"+t])for(var e=DP_settings["YAXIS"+t].split("|"),i=t,n=0;n<e.length;n++)if("P"===e[n].substr(0,1))"0"===e[n].substr(1,1)&&(DP_yAxis[i].position=!1),"1"===e[n].substr(1,1)&&(DP_yAxis[i].position=!0);else if("C"===e[n].substr(0,1))"0"===e[n].substr(1,1)&&(DP_yAxis[i].type=0),"1"===e[n].substr(1,1)&&(DP_yAxis[i].type=1);else if("A"===e[n].substr(0,1))"0"<=e[n].substr(1,1)&&e[n].substr(1,1)<="2"&&(DP_yAxis[i].limit=parseInt(e[n].substr(1,1)));else if("L"===e[n].substr(0,1))DP_yAxis[i].min=parseFloat(e[n].substr(1,15));else if("H"===e[n].substr(0,1))DP_yAxis[i].max=parseFloat(e[n].substr(1,15));else if("G"===e[n].substr(0,1))DP_yAxis[i].tick=parseInt(e[n].substr(1,15));else if("F"===e[n].substr(0,1))DP_yAxis[i].color=parseInt(e[n].substr(1,2));else if("T"===e[n].substr(0,1))try{DP_yAxis[i].text=decodeURIComponent(e[n].substr(1,50))}catch{DP_yAxis[i].text=e[n].substr(1,50)}if(DP_settings.Setting)for(e=DP_settings.Setting.split("|"),n=0;n<e.length;n++)if("L"===e[n].substr(0,1))DP_Legend=parseInt(e[n].substr(1,2));else if("N"===e[n].substr(0,1))DP_Navigator=parseInt(e[n].substr(1,2));else if("P"===e[n].substr(0,1))DP_Labels=parseInt(e[n].substr(1,2));else if("D"===e[n].substr(0,1))DP_DayLight=parseInt(e[n].substr(1,2));else if("G"===e[n].substr(0,1))DP_Grid=parseInt(e[n].substr(1,2));else if("F"===e[n].substr(0,1))DP_ShowFilter=parseInt(e[n].substr(1,2));else if("I"===e[n].substr(0,1))DP_DataPointFilter=parseInt(e[n].substr(1,2));else if("B"===e[n].substr(0,1))"standard_groß"===(DP_Theme=e[n].substr(1,30))?(DP_Theme="standard-light",DP_FontSize=20):"standard_groesser"===DP_Theme&&(DP_Theme="standard-light",DP_FontSize=30);else if("O"===e[n].substr(0,1))DP_FontSize=parseInt(e[n].substr(1,3));else if("R"===e[n].substr(0,1))H2_refreshSec=parseInt(e[n].substr(1,10));else if("T"===e[n].substr(0,1))try{DP_Title=decodeURIComponent(e[n].substr(1,50))}catch{DP_Title=e[n].substr(1,50)}else if("S"===e[n].substr(0,1))try{DP_Subtitle=decodeURIComponent(e[n].substr(1,60))}catch{DP_Subtitle=e[n].substr(1,60)}}}function readLinkData(){var t;if(location.search)for(t of decodeURIComponent(location.search.substring(1)).split("&")){var e=t.split("=");e[0]&&("dp"===e[0].toLowerCase()?DP_Limit=!0:"periode"===e[0].toLowerCase()||"period"===e[0].toLowerCase()?(Zeitraum_Start=new Date(Zeitraum_Ende-new Date(36e5*parseInt(e[1]))),DP_Zoom=parseInt(e[1])):"setting"===e[0].toLowerCase()?readLinkDataSetting(e[1]):"filterkey"===e[0].toLowerCase()?filter_feld=decodeURIComponent(e[1].toLowerCase()):"title"===e[0].toLowerCase()?DP_Title=(DP_Title=decodeURIComponent(e[1])).replaceAll("§","%").replaceAll("µ","&"):"subtitle"===e[0].toLowerCase()?DP_Subtitle=(DP_Subtitle=decodeURIComponent(e[1])).replaceAll("§","%").replaceAll("µ","&"):"legend"===e[0].toLowerCase()?("false"===decodeURIComponent(e[1].toLowerCase())&&(DP_Legend=0),0<=parseInt(decodeURIComponent(e[1]))&&parseInt(decodeURIComponent(e[1]))<7&&(DP_Legend=parseInt(decodeURIComponent(e[1])))):"navigator"===e[0].toLowerCase()?("false"===decodeURIComponent(e[1].toLowerCase())&&(DP_Navigator=3),"0"<=decodeURIComponent(e[1].toLowerCase())&&decodeURIComponent(e[1].toLowerCase())<="4"&&(DP_Navigator=parseInt(decodeURIComponent(e[1])))):"theme"===e[0].toLowerCase()?"standard_groß"===(DP_Theme=decodeURIComponent(e[1].toLowerCase()))?(DP_Theme="standard-light",DP_FontSize=20):"standard_groesser"===DP_Theme&&(DP_Theme="standard-light",DP_FontSize=30):"fontsize"===e[0].toLowerCase()?DP_FontSize=parseInt(decodeURIComponent(e[1])):"dpfilter"===e[0].toLowerCase()?DP_DataPointFilter=parseInt(decodeURIComponent(e[1])):"labels"===e[0].toLowerCase()?("true"===decodeURIComponent(e[1].toLowerCase())&&(DP_Labels=1),"0"<=decodeURIComponent(e[1].toLowerCase())&&decodeURIComponent(e[1].toLowerCase())<="2"&&(DP_Labels=parseInt(decodeURIComponent(e[1])))):"daylight"===e[0].toLowerCase()?("false"===decodeURIComponent(e[1].toLowerCase())&&(DP_DayLight=0),"0"<=decodeURIComponent(e[1].toLowerCase())&&decodeURIComponent(e[1].toLowerCase())<="3"&&(DP_DayLight=parseInt(decodeURIComponent(e[1])))):"grid"===e[0].toLowerCase()?DP_Grid=parseInt(decodeURIComponent(e[1])):"refresh"===e[0].toLowerCase()&&(0<parseInt(decodeURIComponent(e[1]))?H2_refreshSec=parseInt(decodeURIComponent(e[1])):"true"===decodeURIComponent(e[1].toLowerCase())&&(H2_refreshSec=60)))}0<H2_refreshSec&&(AutoRefreshCount=DP_AutoRefresh=H2_refreshSec,setTimeout(autoRefresh,1e3)),createChart()}function readLinkDataSetting(t){var e;if(t)for(e of t.split("|"))switch(e.substr(0,1)){case"L":DP_Legend=parseInt(e.substr(1,2));break;case"N":DP_Navigator=parseInt(e.substr(1,2));break;case"P":DP_Labels=parseInt(e.substr(1,2));break;case"D":DP_DayLight=parseInt(e.substr(1,2));break;case"G":DP_Grid=parseInt(e.substr(1,2));break;case"F":DP_ShowFilter=parseInt(e.substr(1,2));break;case"I":DP_DataPointFilter=parseInt(e.substr(1,2));break;case"B":"standard_groß"===(DP_Theme=e.substr(1,30))?(DP_Theme="standard-light",DP_FontSize=20):"standard_groesser"===DP_Theme&&(DP_Theme="standard-light",DP_FontSize=30);break;case"O":DP_FontSize=parseInt(e.substr(1,3));break;case"R":H2_refreshSec=parseInt(e.substr(1,10));break;case"T":try{DP_Title=decodeURIComponent(e.substr(1,50))}catch{DP_Title=e.substr(1,50)}break;case"S":try{DP_Subtitle=decodeURIComponent(e.substr(1,60))}catch{DP_Subtitle=e.substr(1,60)}}}function requestData2(t){if(t.result){var e,i=[];for(e of t.result)i.push(e);i.sort(function(t,e){t=t.attributes.displayName+"."+t.id.identifier,e=e.attributes.displayName+"."+e.id.identifier;return(t=t.toLowerCase())<(e=e.toLowerCase())?-1:e<t?1:0}),JSON.stringify(i)!==getLocalData("DataPoints")&&(setLocalData("DataPoints",JSON.stringify(i)),DP_point=i,parseDataPoints()),setLocalData("DataPointsTime",Date.now())}}function parseDataPoints(){var e,t,i;if(DP_attribute=[],parseDataPointFill(),location.search)for(i=decodeURIComponent(location.search.substring(1)).split("&"),e=0;e<i.length;e++)if((t=i[e].split("="))[0])if("dp"===t[0].toLowerCase())parseDataPointsDP(decodeURIComponent(t[1]).toLowerCase().split(","),t);else if("yaxis"===t[0].toLowerCase())parseDataPointsAxis(decodeURIComponent(t[1]).toLowerCase().split(","),t);else if("room"===t[0].toLowerCase()){var n,a,o=decodeURIComponent(t[1].toLowerCase());for(a of(n=document.getElementById("Select-Raum")).options)if(a.label.toLowerCase()===o.toLowerCase()||a.value.toLowerCase()===o.toLowerCase()){n.value=a.value;break}}else if("function"===t[0].toLowerCase()){var r,s=decodeURIComponent(t[1].toLowerCase());for(r of(n=document.getElementById("Select-Gewerk")).options)if(r.label.toLowerCase()===s.toLowerCase()||r.value.toLowerCase()===s.toLowerCase()){n.value=r.value;break}}else"filterline"===t[0].toLowerCase()&&("false"!==decodeURIComponent(t[1].toLowerCase())&&"0"!==decodeURIComponent(t[1].toLowerCase())||(DP_ShowFilter=0),"1"===decodeURIComponent(t[1].toLowerCase())&&(DP_ShowFilter=1),"2"===decodeURIComponent(t[1].toLowerCase())&&(DP_ShowFilter=2),"3"===decodeURIComponent(t[1].toLowerCase())&&(DP_ShowFilter=3));for(chart.update({yAxis:defineYAxis(),legend:defineLegend()},!1,!1),$("#Select-Yaxis").empty(),n=document.getElementById("Select-Yaxis"),e=0;e<DP_yAxis.length;e++){let t=document.createElement("option");""!==DP_yAxis[e].text&&null!==DP_yAxis[e].text?t.text=DP_yAxis[e].text:t.text=window.ChhLanguage.default.historian["yaxis"+e],t.value="Y"+e,n.add(t)}showFilterLine(),changeEventRaumFilter(),parseDataPointsZoom()}function parseDataPointFill(){var t,e,i,n=[],a=[];DP_attribute=[],DP_ColorNext=0;for(i of DP_point)if(checkFilter("ALLES","ALLES","",null,i)){if(null!==i.attributes.room)for(var o of i.attributes.room.split(","))""!==o&&-1===n.indexOf(o.trim())&&n.push(o.trim());if(null!==i.attributes.function)for(var r of i.attributes.function.split(","))""!==r&&-1===a.indexOf(r.trim())&&a.push(r.trim());i.attributes.custom&&i.attributes.custom.HighChart&&0<(t=i.attributes.custom.HighChart.split("|")).length&&(e=defaultAttrib(i,-1,i.idx.toString()),DP_attribute.push(e))}n.sort(sortLowercase),$("#Select-Raum").empty();var s,l,u=document.getElementById("Select-Raum");u.options[u.options.length]=new Option(window.ChhLanguage.default.historian.roomALL,"ALLES"),u.options[u.options.length]=new Option(window.ChhLanguage.default.historian.sysvarALL,"SYSVAR");for(s of n)t=s,window.ChhLanguage.default.historian[s]&&(t=window.ChhLanguage.default.historian[s]),u.options[u.options.length]=new Option(t,s);a.sort(sortLowercase),$("#Select-Gewerk").empty(),(u=document.getElementById("Select-Gewerk")).options[u.options.length]=new Option(window.ChhLanguage.default.historian.functionALL,"ALLES");for(l of a)t=l,window.ChhLanguage.default.historian[l]&&(t=window.ChhLanguage.default.historian[l]),u.options[u.options.length]=new Option(t,l);document.getElementById("filterFeld").value=filter_feld}function parseDataPointsZoom(){var t;if(location.search)for(t of decodeURIComponent(location.search.substring(1)).split("&")){let e=t.split("=");if(e[0]&&"zoom"===e[0].toLowerCase()){DP_Zoom=parseFloat(e[1]);let t=new Date(Zeitraum_Ende-new Date(36e5*DP_Zoom));chart.xAxis[0].setExtremes(t.getTime(),Zeitraum_Ende.getTime(),!0)}}}function parseDataPointsDP(t,o){for(let a=0;a<t.length;a++){let i=t[a].toUpperCase().split("|"),n=i[0];if(0<i.length){var r=DP_point.findIndex(t=>t.idx.toString().toUpperCase()===n.toString().toUpperCase()||t.attributes.displayName&&t.attributes.displayName.toUpperCase()===n.toUpperCase()||(t.id.address+"."+t.id.identifier).toUpperCase()===n.toUpperCase());-1!==r&&(n=DP_point[r].idx.toString());let e=DP_attribute.findIndex(t=>t.id===n);if(-1===e){let t;t=defaultAttrib(-1!==r?DP_point[r]:-1,a,n),DP_attribute.push(t),e=DP_attribute.findIndex(t=>t.id===n)}DP_attribute[e].visible=2;for(let t=1;t<i.length;t++)"A"===i[t].substr(0,1)?DP_attribute[e].aggr=i[t]:"Y"===i[t].substr(0,1)?DP_attribute[e].yaxis=i[t]:"T"===i[t].substr(0,1)?DP_attribute[e].atime=i[t]:"F"===i[t].substr(0,1)?DP_attribute[e].color=i[t]:"C"===i[t].substr(0,1)?DP_attribute[e].comp=i[t]:"L"===i[t].substr(0,1)?DP_attribute[e].line=i[t]:"M"===i[t].substr(0,1)?DP_attribute[e].mark=i[t]:"D"===i[t].substr(0,1)?DP_attribute[e].dash=i[t]:"W"===i[t].substr(0,1)?DP_attribute[e].width=i[t]:"S"===i[t].substr(0,1)?DP_attribute[e].stack=parseInt(i[t].substr(1,2)):"V"===i[t].substr(0,1)?DP_attribute[e].visible=parseInt(i[t].substr(1,1)):"U"===i[t].substr(0,1)?DP_attribute[e].unit=decodeURIComponent(o[1]).split(",")[a].split("|")[t].substr(1,20).replaceAll("§","%").replaceAll("µ","&"):"N"===i[t].substr(0,1)?DP_attribute[e].shortname=decodeURIComponent(o[1]).split(",")[a].split("|")[t].substr(1,40).replaceAll("§","%").replaceAll("µ","&"):"X"===i[t].substr(0,1)?DP_attribute[e].factor=parseFloat(i[t].substr(1,10)):"O"===i[t].substr(0,1)&&(DP_attribute[e].offset=parseFloat(i[t].substr(1,10)))}}}function parseDataPointsAxis(t,n){for(let i=0;i<t.length;i++){let e=t[i].toUpperCase().split("|");var a=parseInt(e[0].substr(1,2));if(0<=a&&a<DP_yAxis.length&&0<e.length)for(let t=1;t<e.length;t++)"P"===e[t].substr(0,1)?("0"===e[t].substr(1,1)&&(DP_yAxis[a].position=!1),"1"===e[t].substr(1,1)&&(DP_yAxis[a].position=!0)):"C"===e[t].substr(0,1)?("0"===e[t].substr(1,1)&&(DP_yAxis[a].type=0),"1"===e[t].substr(1,1)&&(DP_yAxis[a].type=1)):"A"===e[t].substr(0,1)?("0"===e[t].substr(1,1)&&(DP_yAxis[a].limit=0),"1"===e[t].substr(1,1)&&(DP_yAxis[a].limit=1),"2"===e[t].substr(1,1)&&(DP_yAxis[a].limit=2)):"L"===e[t].substr(0,1)?DP_yAxis[a].min=parseFloat(e[t].substr(1,15)):"H"===e[t].substr(0,1)?DP_yAxis[a].max=parseFloat(e[t].substr(1,15)):"G"===e[t].substr(0,1)?DP_yAxis[a].tick=parseInt(e[t].substr(1,15)):"F"===e[t].substr(0,1)?DP_yAxis[a].color=parseInt(e[t].substr(1,2)):"T"===e[t].substr(0,1)&&(DP_yAxis[a].text=decodeURIComponent(n[1]).split(",")[i].split("|")[t].substr(1,50).replaceAll("§","%").replaceAll("µ","&"))}}function setStockToolLang(){for(var e in window.Highcharts.seriesTypes){let t=window.Highcharts.seriesTypes[e];t.defaultOptions&&t.defaultOptions.params&&t.prototype&&t.prototype.type&&window.Highcharts.defaultOptions.lang.navigation.popup.indicatorAliases&&window.Highcharts.defaultOptions.lang.navigation.popup.indicatorAliases[t.prototype.type]&&(t.prototype.nameBase=window.Highcharts.defaultOptions.lang.navigation.popup.indicatorAliases[t.prototype.type][0])}}function changeEventRaumFilter(){var t,i,n,a,o=document.getElementById("Select-Raum").value,r=document.getElementById("Select-Gewerk").value,s=!1;for(let t=chart.series.length-1;0<=t;t--)chart.series[t].remove(!1);for(let e of DP_point)checkFilter(o,r,filter_feld,DP_Limit,e)&&(addSerie(e,""),i=chart.get(e.idx.toString()),-1!==(n=DP_attribute.findIndex(t=>t.id===e.idx.toString()))&&(2===DP_attribute[n].visible?s=i.visible=!0:i.visible=!1,"C0"!==(a=DP_attribute[n].comp)&&(-1===(t=DP_attribute.findIndex(t=>t.id===a+"_"+e.idx.toString()))&&(DP_attribute.push({id:a+"_"+e.idx.toString(),aggr:DP_attribute[n].aggr,atime:DP_attribute[n].atime,yaxis:DP_attribute[n].yaxis,comp:"C0",line:DP_attribute[n].line,mark:DP_attribute[n].mark,color:DP_attribute[n].color,visible:DP_attribute[n].visible,dash:"D1",width:DP_attribute[n].width,stack:DP_attribute[n].stack,factor:DP_attribute[n].factor,offset:DP_attribute[n].offset,unit:DP_attribute[n].unit,buffer_data:{timestamps:[],values:[],buffer_start:0,buffer_end:0}}),t=DP_attribute.length-1),addSerie(e,a),(i=chart.get(DP_attribute[t].id))&&(2===DP_attribute[t].visible?s=i.visible=!0:i.visible=!1))));s?(loadNewSerienData(),loadNewAxisInfo()):(loadNewPlotBand(),loadNewAxisInfo(),chart.redraw())}function checkFilter(t,e,i,n,a){if(a.historyDisabled&&(0===DP_DataPointFilter||2===DP_DataPointFilter))return!1;if(a.historyHidden&&(0===DP_DataPointFilter||1===DP_DataPointFilter))return!1;if("ALLES"!==t&&"SYSVAR"!==t){if(null===a.attributes.room)return!1;if(-1===a.attributes.room.indexOf(t))return!1}if("ALLES"!==t&&"SYSVAR"===t&&"SysVar"!==a.id.interfaceId)return!1;if("ALLES"!==e){if(null===a.attributes.function)return!1;if(-1===a.attributes.function.indexOf(e))return!1}var o;if(""!==i)for(o of i.split(" "))if(-1===(a.displayName+"/"+a.id.address+"/ID:"+a.idx).toLowerCase().indexOf(o))return!1;if(n){n=DP_attribute.findIndex(t=>t.id===a.idx.toString());if(-1===n)return!1;if(0===DP_attribute[n].visible)return!1}return!0}function loadNewSerienData(){for(var t of chart.series)t.visible&&"nav"!==t.options.group&&setData(t);loadNewPlotBand(),chart.redraw(),loadNewAxisInfo(),loadingInfo()}function loadNewAxisInfo(){for(var t=0,e=2===DP_Grid||3===DP_Grid||5===DP_Grid||6===DP_Grid?1:0,i=5===DP_Grid||6===DP_Grid?1:0,n=0;n<DP_yAxis.length;n++){var a,o=!1;for(a of chart.yAxis[n].series)if(a.visible){o=!0;break}if(o){t++;var r=null;if(0===DP_yAxis[n].color)r=window.Highcharts.defaultOptions.yAxis.lineColor;else if(1===DP_yAxis[n].color&&0<chart.yAxis[n].series.length){for(var s of chart.yAxis[n].series)if(s.visible){r=s.color;break}}else 1<DP_yAxis[n].color&&DP_yAxis[n].color<chart.options.colors.length+2&&(r=chart.options.colors[DP_yAxis[n].color-2]);null!==r&&r!==chart.yAxis[n].options.lineColor?chart.yAxis[n].update({lineColor:r,labels:{style:{color:r}},title:{style:{color:r}},gridLineWidth:1===t?e:0,minorGridLineWidth:1===t?i:0,minorTickInterval:5===DP_Grid||6===DP_Grid?"auto":null,visible:!0},!1):chart.yAxis[n].update({gridLineWidth:1===t?e:0,minorGridLineWidth:1===t?i:0,minorTickInterval:5===DP_Grid||6===DP_Grid?"auto":null,visible:!0},!1),0===DP_yAxis[n].limit||1===DP_yAxis[n].limit?chart.yAxis[n].setExtremes(null,null):2===DP_yAxis[n].limit&&chart.yAxis[n].setExtremes(parseFloat(DP_yAxis[n].min),parseFloat(DP_yAxis[n].max))}else chart.yAxis[n].update({visible:!1},!1)}chart.redraw(),$(".highcharts-yaxis").off("click",function(){clickShowDialogYAxis(this)}),$(".highcharts-yaxis").on("click",function(){clickShowDialogYAxis(this)}),$(".highcharts-yaxis-labels").off("click",function(){clickShowDialogYAxis(this)}),$(".highcharts-yaxis-labels").on("click",function(){clickShowDialogYAxis(this)})}function loadNewPlotBand(){for(var t,e,i=chart.xAxis[0].plotLinesAndBands.length-1;0<=i;i--){var n=chart.xAxis[0].plotLinesAndBands[i].id;chart.xAxis[0].plotLinesAndBands[i].options.to?chart.xAxis[0].removePlotBand(n):chart.xAxis[0].removePlotLine(n)}var a=1;let o=chart.xAxis.reduce((t,e)=>t.min>e.min?t:e).min,r=chart.xAxis.reduce((t,e)=>t.max>e.max?t:e).max;if((!o||o>Zeitraum_Start.getTime())&&(o=Zeitraum_Start.getTime()),(!r||r<Zeitraum_Ende.getTime())&&(r=Zeitraum_Ende.getTime()),1===DP_DayLight)for(t=o;t<=r;t+=864e5)e=new Date(t),chart.xAxis[0].addPlotBand({color:"rgba(239,232,231,0.5)",from:e.setHours(0,0,0,0),to:e.setHours(6,0,0,0),id:"DayLight1"+a.toString()}),chart.xAxis[0].addPlotBand({color:"rgba(251,252,227,0.5)",from:e.setHours(6,0,0,0),to:e.setHours(20,0,0,0),id:"DayLight2"+a.toString()}),chart.xAxis[0].addPlotBand({color:"rgba(239,232,231,0.5)",from:e.setHours(20,0,0,0),to:e.setHours(23,59,59,999),id:"DayLight3"+a.toString()}),a++;else if(2===DP_DayLight)for(t=o;t<=r;t+=864e5)e=new Date(t),chart.xAxis[0].addPlotLine({color:"#EFE8E7",value:e.setHours(6,0,0,0),width:2,id:"DayLight1"+a.toString()}),chart.xAxis[0].addPlotBand({color:"#EFE8E7",value:e.setHours(20,0,0,0),width:2,id:"DayLight2"+a.toString()}),a++;else if(3===DP_DayLight)for(t=o;t<=r;t+=864e5)e=new Date(t),chart.xAxis[0].addPlotLine({color:"#EFE8E7",value:e.setHours(0,0,0,0),width:2,id:"DayLight1"+a.toString()}),a++}function createUrl(){var t=location.pathname+"?";return t+=generateUrl(),window.open(t,"_blank"),window.focus(),!0}function generateUrl(){let t="periode="+(Math.round((Zeitraum_Ende-Zeitraum_Start)/36e5*100)/100).toString();var e=createUrlSerie();0<e.length&&(t+="&dp="+e.substring(0,e.length-1)),0<(e=createUrlAxis()).length&&(t+="&yaxis="+e.substring(0,e.length-1)),t+="&setting=",t+="L"+DP_Legend.toString(),t+="|N"+DP_Navigator.toString(),t+="|P"+DP_Labels.toString(),t+="|D"+DP_DayLight.toString(),t+="|G"+DP_Grid.toString(),t+="|F"+DP_ShowFilter.toString(),t+="|I"+DP_DataPointFilter.toString(),t+="|B"+DP_Theme,t+="|O"+DP_FontSize,t+="|R"+DP_AutoRefresh,t+="|T"+encodeURIComponent(DP_Title).replace(/'/g,"%27"),t+="|S"+encodeURIComponent(DP_Subtitle).replace(/'/g,"%27");e=document.getElementById("Select-Raum").value;"ALLES"!==e&&(t+="&room="+e);e=document.getElementById("Select-Gewerk").value;"ALLES"!==e&&(t+="&function="+e),""!==filter_feld&&(t+="&filterkey="+filter_feld);e=chart.xAxis[0].getExtremes();return(e.max<e.dataMax||e.min>e.dataMin)&&(t+="&zoom="+(Math.round((e.max-e.min)/36e5*100)/100).toString()),t}function createUrlSerie(){let t,i="";for(let e of chart.series){var n;"nav"===e.options.group||"MinMax"===e.options.name||-1!==(n=DP_attribute.findIndex(t=>t.id===e.options.id.toString()))&&(2===DP_attribute[n].visible||1===DP_attribute[n].visible&&DP_Limit)&&(i+=e.options.id,i+="|"+DP_attribute[n].aggr,i+="|"+DP_attribute[n].atime,i+="|"+DP_attribute[n].yaxis,i+="|"+DP_attribute[n].line,i+="|"+DP_attribute[n].color,i+="|"+DP_attribute[n].comp,i+="|"+DP_attribute[n].mark,i+="|"+DP_attribute[n].dash,i+="|"+DP_attribute[n].width,i+="|S"+DP_attribute[n].stack,i+="|X"+DP_attribute[n].factor,i+="|O"+DP_attribute[n].offset,t="C"===e.options.id.substr(0,1)?DP_point.findIndex(t=>t.idx.toString()===e.options.id.split("_")[1].toString()):DP_point.findIndex(t=>t.idx.toString()===e.options.id.toString()),-1!==t&&DP_point[t].attributes.unit===DP_attribute[n].unit||(i+="|U"+DP_attribute[n].unit.replaceAll("%","§").replaceAll("&","µ")),""!==DP_attribute[n].shortname&&(i+="|N"+DP_attribute[n].shortname.replaceAll("%","§").replaceAll("&","µ")),i+="|V"+DP_attribute[n].visible,i+=",")}return i}function createUrlAxis(){let e="";for(let t=0;t<DP_yAxis.length;t++)chart.yAxis[t].visible&&chart.yAxis[t].hasVisibleSeries&&(e+="Y"+t,e+="|P"+(DP_yAxis[t].position?"1":"0"),e+="|C"+DP_yAxis[t].type,e+="|A"+DP_yAxis[t].limit,e+="|L"+DP_yAxis[t].min,e+="|H"+DP_yAxis[t].max,e+="|G"+DP_yAxis[t].tick,e+="|F"+DP_yAxis[t].color,DP_yAxis[t].text?e+="|T"+DP_yAxis[t].text.replaceAll("%","§").replaceAll("&","µ"):e+="|T",e+=",");return e}function autoRefresh(){var t;0<DP_AutoRefresh?(setTimeout(autoRefresh,1e3),DP_Navigator<3&&(document.getElementById("autorefresh").innerHTML=" - "+window.ChhLanguage.default.historian.autorefreshText+":"+AutoRefreshCount+" Sek."),--AutoRefreshCount<=0&&(AutoRefreshCount=DP_AutoRefresh,t=Zeitraum_Ende.getTime()-Zeitraum_Start.getTime(),Zeitraum_Ende=new Date(Date.now()),Zeitraum_Start=new Date(Zeitraum_Ende-new Date(t)),((t=chart.xAxis[0].getExtremes()).max<t.dataMax||t.min>t.dataMin)&&(DP_Zoom=Math.round((t.max-t.min)/36e5*100)/100),loadNewSerienData())):document.getElementById("autorefresh").innerHTML=""}function loadingInfo(){if(0<DP_Queue.length)chart.showLoading();else{if(chart.hideLoading(),DP_Button_Jump)chart.xAxis[0].setExtremes(Zeitraum_Start.getTime(),Zeitraum_Ende.getTime(),!0);else if(0<DP_Zoom){let t=new Date(Zeitraum_Ende-new Date(36e5*DP_Zoom));chart.xAxis[0].setExtremes(t.getTime(),Zeitraum_Ende.getTime(),!0)}DP_Button_Jump=!1,DP_Zoom=0}0<DP_Queue.length&&DP_Navigator<3?(DP_Loading!==DP_Queue.length&&(document.getElementById("loading").innerHTML=" (Loading - "+DP_Queue.length+') <img src="loading.gif" alt="loading" height="20" width="20">',DP_Loading=DP_Queue.length),setTimeout(loadingInfo,500)):(document.getElementById("loading").innerHTML="",DP_Loading=0)}function addAggregationMinMax(t){for(var e=[],i=chart.series.length-1;0<=i;i--)t.options.id===chart.series[i].options.linkedTo&&"MinMax"===chart.series[i].options.name&&chart.series[i].remove(!1);t.userOptions.data.forEach(function(t){e.push([t[0],t[1],t[1]])}),chart.addSeries({name:"MinMax",fillOpacity:.4,color:t.color,yAxis:t.options.yAxis,linkedTo:t.options.id,type:"arearange",lineWidth:1,dataGrouping:{enabled:!0,forced:!0,groupPixelWidth:10,units:t.userOptions.dataGrouping.units},data:e,tooltip:{valueDecimals:t.userOptions.tooltip.valueDecimals,valueSuffix:t.userOptions.tooltip.valueSuffix}})}function showDialogLine(e){if(e.options.id){"C"===e.options.id.toString().substr(0,1)?document.getElementById("compare").style.display="none":document.getElementById("compare").style.display="";var i="";let t;t="C"===e.options.id.substr(0,1)?DP_point.findIndex(t=>t.idx.toString()===e.options.id.split("_")[1].toString()):DP_point.findIndex(t=>t.idx.toString()===e.options.id.toString()),i=-1===t?"n/a":"SysVar"===DP_point[t].id.interfaceId?"<br/>Systemvariable":"<br/>"+DP_point[t].id.interfaceId+"."+DP_point[t].id.address+"."+DP_point[t].id.identifier,DP_PopupID=e.options.id.toString();var n,a=DP_attribute.findIndex(t=>t.id===e.options.id.toString());-1===a&&(n=-1===t?defaultAttrib(-1,e.colorIndex,DP_PopupID):defaultAttrib(DP_point[t],e.colorIndex,DP_PopupID),DP_attribute.push(n),a=DP_attribute.length-1),document.getElementsByClassName("modal-title")[0].innerHTML=e.name+i,document.getElementById("Select-Aggregation").value=DP_attribute[a].aggr,document.getElementById("Select-AggrTime").value=DP_attribute[a].atime,document.getElementById("Select-Yaxis").value=DP_attribute[a].yaxis,document.getElementById("Select-Compare").value=DP_attribute[a].comp,document.getElementById("Select-Stacking").value=DP_attribute[a].stack,document.getElementById("Select-Line").value=DP_attribute[a].line,document.getElementById("Select-Color").value=DP_attribute[a].color,document.getElementById("Select-Marker").value=DP_attribute[a].mark,document.getElementById("Select-DashType").value=DP_attribute[a].dash,document.getElementById("Select-LineWidth").value=DP_attribute[a].width,document.getElementById("Line-Factor").value=DP_attribute[a].factor,document.getElementById("Line-OffSet").value=DP_attribute[a].offset,document.getElementById("Line-Unit").value=DP_attribute[a].unit,document.getElementById("Line-ShortName").value=DP_attribute[a].shortname,document.getElementById("Select-Color").style.backgroundColor=chart.options.colors[parseInt(document.getElementById("Select-Color").value.substr(1,2))],$("#LinePopup").modal()}}function saveLine(){getDialogLine();var t,e,i,n=DP_attribute.findIndex(t=>t.id===DP_PopupID);-1!==n&&(i="",i+=DP_attribute[n].aggr,i+="|"+DP_attribute[n].atime,i+="|"+DP_attribute[n].yaxis,i+="|"+DP_attribute[n].line,i+="|"+DP_attribute[n].color,i+="|"+DP_attribute[n].comp,i+="|"+DP_attribute[n].mark,i+="|"+DP_attribute[n].dash,i+="|"+DP_attribute[n].width,i+="|S"+DP_attribute[n].stack,i+="|X"+DP_attribute[n].factor,i+="|O"+DP_attribute[n].offset,i+="|U"+encodeURIComponent(DP_attribute[n].unit).replace(/'/g,"%27"),i+="|N"+encodeURIComponent(DP_attribute[n].shortname).replace(/'/g,"%27"),t=DP_point.findIndex(t=>t.idx.toString()===DP_PopupID),e="POINT"+DP_PopupID,DP_point[t].attributes.custom||(DP_point[t].attributes.custom={}),DP_point[t].attributes.custom.HighChart!==i&&(DP_point[t].attributes.custom.HighChart=i,setLocalData("DataPoints",JSON.stringify(DP_point)),setLocalData("DataPointsTime",Date.now()),n="http://"+H2_server+":"+H2_port,n+="/query/jsonrpc.gy",n+=""===DP_ApiKey?"":"?"+DP_ApiKey,i={id:e,method:"updateDataPoint",params:[{id:{interfaceId:DP_point[t].id.interfaceId,address:DP_point[t].id.address,identifier:DP_point[t].id.identifier},attributes:{custom:{HighChart:i}}}]},i=JSON.stringify(i),$.ajax({url:n,dataType:"json",contentType:"application/json",type:"post",data:i,cache:!1,async:!0,error:function(t,e,i){ajaxErrorOutput(t,e,i)},success:function(t){console.log(t)}})))}function getDialogLine(){var t,e=DP_attribute.findIndex(t=>t.id===DP_PopupID);DP_attribute[e].comp===document.getElementById("Select-Compare").value||"C0"===document.getElementById("Select-Compare").value||"C0"===DP_attribute[e].comp||-1!==(t=DP_attribute.findIndex(t=>"C"===t.id.substr(0,1)&&t.id.split("_")[1]===DP_PopupID))&&(DP_attribute[t].id=document.getElementById("Select-Compare").value+"_"+DP_PopupID),DP_attribute[e].aggr=document.getElementById("Select-Aggregation").value,DP_attribute[e].atime=document.getElementById("Select-AggrTime").value,DP_attribute[e].yaxis=document.getElementById("Select-Yaxis").value,DP_attribute[e].comp=document.getElementById("Select-Compare").value,DP_attribute[e].stack=parseInt(document.getElementById("Select-Stacking").value),DP_attribute[e].line=document.getElementById("Select-Line").value,DP_attribute[e].color=document.getElementById("Select-Color").value,DP_attribute[e].mark=document.getElementById("Select-Marker").value,DP_attribute[e].dash=document.getElementById("Select-DashType").value,DP_attribute[e].width=document.getElementById("Select-LineWidth").value,DP_attribute[e].factor=parseFloat(document.getElementById("Line-Factor").value),DP_attribute[e].offset=parseFloat(document.getElementById("Line-OffSet").value),DP_attribute[e].unit=document.getElementById("Line-Unit").value,DP_attribute[e].shortname=document.getElementById("Line-ShortName").value,!isNaN(DP_attribute[e].factor)&&0!==DP_attribute[e].factor||(DP_attribute[e].factor=1),$("#LinePopup").modal("hide"),changeEventRaumFilter()}function showDialogSettings(){document.getElementsByClassName("modal-title2")[0].innerHTML=window.ChhLanguage.default.historian.settings,document.getElementById("Select-Legend").value=DP_Legend.toString(),document.getElementById("Select-Navigator").value=DP_Navigator.toString(),document.getElementById("Select-Label").value=DP_Labels.toString(),document.getElementById("Select-Layout").value=DP_DayLight.toString(),document.getElementById("Select-Grid").value=DP_Grid.toString(),document.getElementById("Select-Content").value=DP_ShowFilter.toString(),document.getElementById("Select-DataPoint").value=DP_DataPointFilter.toString(),document.getElementById("Select-Theme").value=DP_Theme,document.getElementById("Select-FontSize").value=DP_FontSize,document.getElementById("Line-Refresh").value=DP_AutoRefresh,document.getElementById("Line-Title").value=DP_Title,document.getElementById("Line-Subtitle").value=DP_Subtitle,$("#SettingPopup").modal()}function saveSetting(){getDialogSetting();var t="";t+="L"+DP_Legend.toString(),t+="|N"+DP_Navigator.toString(),t+="|P"+DP_Labels.toString(),t+="|D"+DP_DayLight.toString(),t+="|G"+DP_Grid.toString(),t+="|F"+DP_ShowFilter.toString(),t+="|I"+DP_DataPointFilter.toString(),t+="|B"+DP_Theme,t+="|O"+DP_FontSize,t+="|R"+DP_AutoRefresh,t+="|T"+encodeURIComponent(DP_Title).replace(/'/g,"%27"),t+="|S"+encodeURIComponent(DP_Subtitle).replace(/'/g,"%27"),DP_settings.Setting=t,saveSettingsH2()}function saveSettingsH2(){var t,e=JSON.stringify(DP_settings);e!==JSON.stringify(DP_settings_old)&&(setLocalData("setting",e),setLocalData("settingTime",Date.now()),DP_settings_old=JSON.parse(e),t="http://"+H2_server+":"+H2_port,t+="/query/jsonrpc.gy",t+=""===DP_ApiKey?"":"?"+DP_ApiKey,e={id:"SETTING",method:"setConfig",params:["HighChart",e=e.replace(/'/g,"'")]},e=JSON.stringify(e),$.ajax({url:t,dataType:"json",contentType:"application/json",type:"post",data:e,cache:!1,async:!0,error:function(t,e,i){ajaxErrorOutput(t,e,i)},success:function(t){console.log(t)}}))}function getDialogSetting(){$("#SettingPopup").modal("hide");var t=!1,e=!1;DP_Legend.toString()!==document.getElementById("Select-Legend").value&&(DP_Legend=parseInt(document.getElementById("Select-Legend").value),e=!0),DP_Navigator.toString()!==document.getElementById("Select-Navigator").value&&(DP_Navigator=parseInt(document.getElementById("Select-Navigator").value),e=!0),DP_Title!==document.getElementById("Line-Title").value&&(DP_Title=document.getElementById("Line-Title").value,e=!0),DP_Subtitle!==document.getElementById("Line-Subtitle").value&&(DP_Subtitle=document.getElementById("Line-Subtitle").value,e=!0),DP_Labels.toString()!==document.getElementById("Select-Label").value&&(DP_Labels=parseInt(document.getElementById("Select-Label").value),t=!0),DP_DayLight.toString()!==document.getElementById("Select-Layout").value&&(DP_DayLight=parseInt(document.getElementById("Select-Layout").value),t=!0),DP_Grid.toString()!==document.getElementById("Select-Grid").value&&(DP_Grid=parseInt(document.getElementById("Select-Grid").value),chartSetOptions(),t=!0),DP_ShowFilter.toString()!==document.getElementById("Select-Content").value&&(DP_ShowFilter=parseInt(document.getElementById("Select-Content").value),showFilterLine(),chartSetOptions(),t=!0),DP_DataPointFilter.toString()!==document.getElementById("Select-DataPoint").value&&(DP_DataPointFilter=parseInt(document.getElementById("Select-DataPoint").value),e=!0),DP_Theme!==document.getElementById("Select-Theme").value&&(DP_Theme=document.getElementById("Select-Theme").value,e=!0),DP_FontSize.toString()!==document.getElementById("Select-FontSize").value&&(DP_FontSize=parseInt(document.getElementById("Select-FontSize").value),e=!0),DP_AutoRefresh!==parseInt(document.getElementById("Line-Refresh").value)&&(H2_refreshSec=parseInt(document.getElementById("Line-Refresh").value),AutoRefreshCount=H2_refreshSec,0===DP_AutoRefresh&&0<H2_refreshSec&&setTimeout(autoRefresh,1e3),DP_AutoRefresh=H2_refreshSec),e?createChart():t&&changeEventRaumFilter()}function showDialogFav(){if(document.getElementsByClassName("modal-title4")[0].innerHTML=window.ChhLanguage.default.historian.favoritTitle,document.getElementById("Line-Title4").value="",document.getElementById("Text-Title4").innerHTML=window.ChhLanguage.default.historian.favoritName,document.getElementById("favAdd").innerHTML=window.ChhLanguage.default.historian.favoritNEW,DP_settings.Favorites){let t=document.getElementById("favList");t.childNodes&&0<t.childNodes.length&&t.removeChild(t.childNodes[0]);let e=document.createElement("table");e.setAttribute("width","100%"),e.setAttribute("style","border: 0px; margin-top: 22px;");let r=document.createElement("tbody");for(let o=0;o<DP_settings.Favorites.length;o++){let t=document.createElement("tr"),e=document.createElement("td");e.setAttribute("style","border: 0px;");let i=document.createElement("button");i.innerHTML=decodeURIComponent(DP_settings.Favorites[o].Name),i.setAttribute("class","bnt btn-default"),i.setAttribute("onclick","executeFav("+o+");"),i.setAttribute("draggable","true"),i.setAttribute("ondragstart","drag(event,"+o+")"),i.setAttribute("ondrop","drop(event,"+o+")"),i.setAttribute("ondragover","allowDrop(event,"+o+")"),i.setAttribute("style","width: 90%;"),e.appendChild(i),t.appendChild(e);let n=document.createElement("td");n.setAttribute("style","border: 0px;");let a=document.createElement("button");a.setAttribute("class","bnt btn-default"),a.setAttribute("onclick","deleteFav("+o+");"),a.setAttribute("style","font-size: 21px;"),a.textContent="x",n.appendChild(a),t.appendChild(n),r.appendChild(t)}e.appendChild(r),t.appendChild(e),e.setAttribute("border","2")}$("#FavPopup").modal()}function allowDrop(t){return t.preventDefault(),!1}function drag(t,e){DP_Drag_Pos=e,t.dataTransfer.setData("text",t.target.id)}function drop(t,e){t.stopPropagation();t=DP_settings.Favorites[DP_Drag_Pos];return DP_settings.Favorites.splice(DP_Drag_Pos,1),DP_settings.Favorites.splice(e,0,t),saveSettingsH2(),showDialogFav(),!1}function deleteFav(t){$("#FavPopup").modal("hide"),DP_settings.Favorites[t]&&(DP_settings.Favorites.splice(t,1),saveSettingsH2())}function executeFav(t){$("#FavPopup").modal("hide"),DP_settings.Favorites[t]&&(t=location.pathname+"?"+decodeURIComponent(DP_settings.Favorites[t].Url),window.open(t,"_self"))}function getDialogFav(){$("#FavPopup").modal("hide"),document.getElementById("Line-Title4").value&&(DP_settings.Favorites||(DP_settings.Favorites=[]),DP_settings.Favorites.push({Name:encodeURIComponent(document.getElementById("Line-Title4").value).replace(/'/g,"%27"),Url:encodeURIComponent(generateUrl()).replace(/'/g,"%27")}),saveSettingsH2())}function showFilterLine(){0===DP_ShowFilter?(document.getElementById("filter").style.display="none",$("nav.navbar.navbar-default")[0].style.display="none"):1===DP_ShowFilter?(document.getElementById("filter").style.display="block",$("nav.navbar.navbar-default")[0].style.display="block"):2===DP_ShowFilter?(document.getElementById("filter").style.display="block",$("nav.navbar.navbar-default")[0].style.display="none"):3===DP_ShowFilter&&(document.getElementById("filter").style.display="none",$("nav.navbar.navbar-default")[0].style.display="block"),document.getElementById("container").setAttribute("style","height:"+calcContSize().toString()+"px"),chart&&chart.setSize(null,null,!1)}function defineLegend(){var t={};return(t=0===DP_Legend?{enabled:!1}:2===DP_Legend?{enabled:!0,layout:"vertical",align:"right",verticalAlign:"top",floating:!1,y:DP_Navigator<4?-30:0,maxHeight:$(window).height()-(0===DP_ShowFilter?90:0)-(1===DP_ShowFilter?200:0)-(2===DP_ShowFilter?120:0)-(3===DP_ShowFilter?180:0)}:3===DP_Legend?{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"top",floating:!0,y:10+(""===DP_Title?0:DP_FontSize+20)+(""===DP_Subtitle?0:DP_FontSize/6+5+15),maxHeight:200}:4===DP_Legend?{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"bottom",floating:!0,y:-30-DP_FontSize-(0===DP_Navigator?20+4.5*DP_FontSize:0)-(1===DP_Navigator?15+3.5*DP_FontSize:0)-(2===DP_Navigator?11+2*DP_FontSize:0),maxHeight:200}:5===DP_Legend?{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"top",floating:!1,y:0,maxHeight:200}:6===DP_Legend?{enabled:!0,layout:"horizontal",align:"center",verticalAlign:"bottom",floating:!1,y:0,maxHeight:200}:{enabled:!0,layout:"vertical",align:"left",verticalAlign:"top",floating:!1,y:DP_Navigator<4?-30:0,maxHeight:$(window).height()-(0===DP_ShowFilter?90:0)-(1===DP_ShowFilter?200:0)-(2===DP_ShowFilter?120:0)-(3===DP_ShowFilter?180:0)}).x=0,t}function showDialogYAxis(t){document.getElementsByClassName("modal-title3")[0].innerHTML=window.ChhLanguage.default.historian.axissetting+" "+t.substr(5,2);t=parseInt(t.substr(5,2));0<=t&&t<chart.options.yAxis.length&&(DP_PopupAxisPos=t,document.getElementById("Line-Title3").value=DP_yAxis[DP_PopupAxisPos].text,document.getElementById("Select-Position").value=DP_yAxis[DP_PopupAxisPos].position?"1":"0",document.getElementById("Line-Min").value=DP_yAxis[DP_PopupAxisPos].min,document.getElementById("Line-Max").value=DP_yAxis[DP_PopupAxisPos].max,document.getElementById("Line-TickAmount").value=DP_yAxis[DP_PopupAxisPos].tick,document.getElementById("Select-AxisColor").value=DP_yAxis[DP_PopupAxisPos].color,document.getElementById("Select-Limit").value=DP_yAxis[DP_PopupAxisPos].limit,document.getElementById("Select-AxisType").value=DP_yAxis[DP_PopupAxisPos].type,showDialogYAxisUpdatColor(),$("#AxisPopup").modal())}function getDialogAxis(){$("#AxisPopup").modal("hide");let t={title:{text:document.getElementById("Line-Title3").value},lineWidth:2,opposite:"1"===document.getElementById("Select-Position").value,type:"1"===document.getElementById("Select-AxisType").value?"logarithmic":"linear",tickAmount:parseInt(document.getElementById("Line-TickAmount").value),min:"2"===document.getElementById("Select-Limit").value?parseFloat(document.getElementById("Line-Min").value):null,max:"2"===document.getElementById("Select-Limit").value?parseFloat(document.getElementById("Line-Max").value):null,softMin:"1"===document.getElementById("Select-Limit").value?parseFloat(document.getElementById("Line-Min").value):null,softMax:"1"===document.getElementById("Select-Limit").value?parseFloat(document.getElementById("Line-Max").value):null,startOnTick:"2"!==document.getElementById("Select-Limit").value,endOnTick:"2"!==document.getElementById("Select-Limit").value,allowDecimals:!0,tickPositioner:null};"2"===document.getElementById("Select-Limit").value&&(t.tickPositioner=function(){const e=this;return e.tickPositions.map(t=>tickPos(e,t))}),chart.yAxis[DP_PopupAxisPos].update(t),DP_yAxis[DP_PopupAxisPos].text=document.getElementById("Line-Title3").value,DP_yAxis[DP_PopupAxisPos].position=0!==parseInt(document.getElementById("Select-Position").value),DP_yAxis[DP_PopupAxisPos].limit=parseInt(document.getElementById("Select-Limit").value),DP_yAxis[DP_PopupAxisPos].type=parseInt(document.getElementById("Select-AxisType").value),DP_yAxis[DP_PopupAxisPos].min=parseFloat(document.getElementById("Line-Min").value),DP_yAxis[DP_PopupAxisPos].max=parseFloat(document.getElementById("Line-Max").value),DP_yAxis[DP_PopupAxisPos].tick=parseInt(document.getElementById("Line-TickAmount").value),DP_yAxis[DP_PopupAxisPos].color=parseInt(document.getElementById("Select-AxisColor").value),$("#Select-Yaxis").empty();for(var e=document.getElementById("Select-Yaxis"),i=0;i<DP_yAxis.length;i++){var n=document.createElement("option");""!==DP_yAxis[i].text&&null!==DP_yAxis[i].text?n.text=DP_yAxis[i].text:n.text=window.ChhLanguage.default.historian["yaxis"+i],n.value="Y"+i,e.add(n)}loadNewAxisInfo()}function defineYAxis(){for(var e=[],i=0;i<DP_yAxis.length;i++){let t={id:"AXISY"+i,className:"axisy"+i,type:1===DP_yAxis[i].type?"logarithmic":"linear",title:{text:DP_yAxis[i].text},lineWidth:2,opposite:DP_yAxis[i].position,tickAmount:DP_yAxis[i].tick,min:2===DP_yAxis[i].limit?DP_yAxis[i].min:null,max:2===DP_yAxis[i].limit?DP_yAxis[i].max:null,softMin:1===DP_yAxis[i].limit?DP_yAxis[i].min:null,softMax:1===DP_yAxis[i].limit?DP_yAxis[i].max:null,startOnTick:2!==DP_yAxis[i].limit,endOnTick:2!==DP_yAxis[i].limit,allowDecimals:!0,visible:!1,tickPositioner:null};2===DP_yAxis[i].limit&&(t.tickPositioner=function(){const e=this;return e.tickPositions.map(t=>tickPos(e,t))}),e.push(t)}return e}function tickPos(t,e){let i=e;return i>t.max?i=t.max:i<t.min&&(i=t.min),i}function showDialogYAxisUpdatColor(){var t=parseInt(document.getElementById("Select-AxisColor").value);0===t||1===t?document.getElementById("Select-AxisColor").style.backgroundColor=window.Highcharts.defaultOptions.yAxis.lineColor:(t-=2,document.getElementById("Select-AxisColor").style.backgroundColor=chart.options.colors[t])}function getComparisionBackDay(t){return"C1"===t?-864e5:"C2"===t?-1728e5:"C3"===t?-2592e5:"C4"===t?-3456e5:"C5"===t?-6048e5:"C6"===t?-12096e5:"C7"===t?-18144e5:"C8"===t||"C9"===t?-24192e5:"C10"===t?-48384e5:"C11"===t?-72576e5:"C12"===t?-96768e5:"C13"===t?-31536e6:0}function chartSetOptions(){let t="";window.Highcharts.getOptions().navigation&&window.Highcharts.getOptions().navigation.bindings&&window.Highcharts.getOptions().navigation.bindings.labelAnnotation&&(t=window.Highcharts.getOptions().navigation.bindings.labelAnnotation);var e={lang:window.ChhLanguage.default.highcharts,chart:{events:{load:requestInitData,beforePrint:function(){var t;window.DP_Themes.transparent&&(t=window.Highcharts.merge(window.DP_Themes["standard-light"],window.DP_Themes.transparent),this.update(t))},afterPrint:function(){this.update(DP_Theme_Setting),chartSetOptions(),chartSetElements()}},panning:!0,panKey:"shift",zoomType:"xy",resetZoomButton:{position:{x:-50,y:20},relativeTo:"plot",theme:{style:{"font-size":DP_FontSize.toString()+"px"}}}},rangeSelector:{enabled:DP_Navigator<4,buttons:[{count:30,type:"minute",text:window.ChhLanguage.default.historian.range30M,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitle30M},{count:1,type:"hour",text:window.ChhLanguage.default.historian.rangeH,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitleH},{count:6,type:"hour",text:window.ChhLanguage.default.historian.range6H,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitle6H},{count:1,type:"day",text:window.ChhLanguage.default.historian.rangeD,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitleD},{count:1,type:"week",text:window.ChhLanguage.default.historian.rangeW,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitleW},{count:1,type:"month",text:window.ChhLanguage.default.historian.rangeM,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitleM},{count:1,type:"year",text:window.ChhLanguage.default.historian.rangeY,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitleY},{type:"all",text:window.ChhLanguage.default.historian.rangeALL,events:{click:function(){return checkZeitraum(this),!0}},title:window.ChhLanguage.default.historian.rangeTitleALL}],allButtonsEnabled:!0,inputEnabled:!1,selected:7,floating:!1,verticalAlign:"top",buttonPosition:{align:"left",x:0},x:0,y:10},navigator:{enabled:0===DP_Navigator||1===DP_Navigator},scrollbar:{enabled:0===DP_Navigator||2===DP_Navigator},credits:{enabled:DP_Navigator<3,text:"(c) wak - H2-HighChart version "+H2_version+" - verwendet Highstock http://www.highcharts.com - Kommerzielle Nutzung untersagt",href:"https://github.com/wakr70/CCU-Historian-HC"},exporting:{buttons:{contextButton:{symbol:"menu",enabled:DP_Navigator<4,menuItems:[{text:window.ChhLanguage.default.historian.favoritTxt,onclick:function(){showDialogFav()}},{text:window.ChhLanguage.default.historian.settings,onclick:function(){showDialogSettings()}},{text:DP_Limit?window.ChhLanguage.default.historian.limitactive:window.ChhLanguage.default.historian.limitdeactive,onclick:function(){return DP_Limit=DP_Limit?($(".highcharts-contextmenu")[0].children[0].children[2].innerHTML=window.ChhLanguage.default.historian.limitdeactive,!1):($(".highcharts-contextmenu")[0].children[0].children[2].innerHTML=window.ChhLanguage.default.historian.limitactive,!0),changeEventRaumFilter(),!0}},{text:window.ChhLanguage.default.historian.buttonRefresh,onclick:function(){return refreshClick(),!0}},{text:window.ChhLanguage.default.historian.buttonLink,onclick:function(){return createUrl(),!0}},"separator","viewFullscreen","printChart","downloadPNG","downloadJPEG","downloadPDF","downloadSVG","separator","downloadCSV","downloadXLS","viewData"]}}},title:{text:DP_Title,floating:!1},subtitle:{text:DP_Subtitle,floating:!1},xAxis:{type:"datetime",ordinal:!1,gridLineWidth:1===DP_Grid||3===DP_Grid||4===DP_Grid||6===DP_Grid?1:0,minorGridLineWidth:4===DP_Grid||6===DP_Grid?1:0,minorTickInterval:4===DP_Grid||6===DP_Grid?"auto":null,dataMax:Date.now(),events:{afterSetExtremes:function(){showAggrText()}}},yAxis:defineYAxis(),plotOptions:{series:{events:{legendItemClick:function(t){let e;if(t.browserEvent.shiftKey)return showDialogLine(this),!1;if(this.visible||setData(this),this.visible){if(e=DP_attribute.findIndex(t=>t.id===this.options.id.toString()),-1!==e&&(DP_attribute[e].visible=DP_Limit?1:0,"A3"===DP_attribute[e].aggr))for(var i=chart.series.length-1;0<=i;i--)this.options.id===chart.series[i].options.linkedTo&&"MinMax"===chart.series[i].options.name&&chart.series[i].remove(!1)}else e=DP_attribute.findIndex(t=>t.id===this.options.id.toString()),-1!==e&&(DP_attribute[e].visible=2);return!0},show:function(){loadNewAxisInfo()},hide:function(){loadNewAxisInfo()},click:function(){let t=!1;return arguments[0]&&arguments[0].activeAnnotation&&(t=!0),t||showDialogLine(this),!0}}}},series:[{id:"series-init",name:"loading ....",data:[],yAxis:0,visible:!1}],navigation:{buttonOptions:{enabled:DP_Navigator<4},bindings:{myText:t}},stockTools:{gui:{iconsURL:"stock-tools/stock-icons/",buttons:["indicators","separator","myText","lines","measure","toggleAnnotations","separator","verticalLabels","separator","zoomChange","fullScreen"],definitions:{zoomChange:{items:["zoomXY","zoomY","zoomX"]},myText:{className:"highcharts-label-annotation",symbol:"label.svg"}}}}};(chart=window.Highcharts.stockChart("container",e))||alert("HighChart Option error!")}function showAggrText(){var i,n;if(DP_Navigator<3){for(let e of chart.series)if(e.visible&&"nav"!==e.options.group){var a=e.currentDataGrouping;if(a){let t=a.unitName+(1<a.count?"2":"").toString();window.ChhLanguage.default.historian["aggr"+t]&&(t=window.ChhLanguage.default.historian["aggr"+t]),e.options.id&&(n=0,-1!==(i=DP_attribute.findIndex(t=>t.id===e.options.id.toString()))&&(n=parseInt(DP_attribute[i].aggr.substr(1,2)))),document.getElementById("aggr_text").innerHTML=1===n?" - "+window.ChhLanguage.default.historian.aggrtxt1+": "+a.count+"/"+t:2===n?" - "+window.ChhLanguage.default.historian.aggrtxt2+": "+a.count+"/"+t:3===n?" - "+window.ChhLanguage.default.historian.aggrtxt3+": "+a.count+"/"+t:4===n?" - "+window.ChhLanguage.default.historian.aggrtxt4+": "+a.count+"/"+t:5===n?" - "+window.ChhLanguage.default.historian.aggrtxt5+": "+a.count+"/"+t:6===n?" - "+window.ChhLanguage.default.historian.aggrtxt6:7===n?" - "+window.ChhLanguage.default.historian.aggrtxt7+": "+a.count+"/"+t:" - "+window.ChhLanguage.default.historian.aggrtxt1+": "+a.count+"/"+t}else document.getElementById("aggr_text").innerHTML=" -  "+window.ChhLanguage.default.historian.aggrtxt0;break}}else document.getElementById("aggr_text").innerHTML=""}function chartSetElements(){var t,e,i;for("string"==typeof chart.options.chart.backgroundColor?$("body").css("background-color",chart.options.chart.backgroundColor):"string"==typeof chart.options.background2?$("body").css("background-color",chart.options.background2):"string"==typeof chart.options.chart.borderColor&&$("body").css("background-color",chart.options.chart.borderColor),$("#message").css("color",chart.options.labels.style.color),"string"==typeof DP_Theme_Setting.background2&&($(".navbar-default").css("background-color",DP_Theme_Setting.background2),$(".btn-default").css("background-color",DP_Theme_Setting.background2),$(".form-select-h2").css("background-color",DP_Theme_Setting.background2),$(".form-input-h2").css("background-color",DP_Theme_Setting.background2),$("div.modal-content").css("background-color",DP_Theme_Setting.background2)),"string"==typeof DP_Theme_Setting.textColor&&($(".navbar-default").css("color",DP_Theme_Setting.textColor),$(".btn-default").css("color",DP_Theme_Setting.textColor),$(".btn-default").css("border-color",DP_Theme_Setting.textColor),$(".form-select-h2").css("color",DP_Theme_Setting.textColor),$(".form-select-h2").css("border-color",DP_Theme_Setting.textColor),$(".form-input-h2").css("color",DP_Theme_Setting.textColor),$(".form-input-h2").css("border-color",DP_Theme_Setting.textColor),$("div.modal-content").css("color",DP_Theme_Setting.textColor),$("div.modal-content").css("border-color",DP_Theme_Setting.textColor)),$("#Select-Color").empty(),t=document.getElementById("Select-Color"),i=0;i<chart.options.colors.length;i++)(e=document.createElement("option")).text="Color "+i,e.value="F"+i,e.style.backgroundColor=chart.options.colors[i],t.add(e);for($("#Select-Marker").empty(),t=document.getElementById("Select-Marker"),(e=document.createElement("option")).text="none",e.value="M0",t.add(e),i=0;i<chart.options.symbols.length;i++)(e=document.createElement("option")).text=chart.options.symbols[i],e.value="M"+(i+1),t.add(e);for(i=0;i<chart.options.symbols.length;i++)(e=document.createElement("option")).text=chart.options.symbols[i]+"-RS",e.value="M"+(i+1+chart.options.symbols.length),t.add(e);for(i=0;i<chart.options.symbols.length;i++)(e=document.createElement("option")).text=chart.options.symbols[i]+"-RW",e.value="M"+(i+1+2*chart.options.symbols.length),t.add(e);for(i=0;i<chart.options.symbols.length;i++)(e=document.createElement("option")).text=chart.options.symbols[i]+"-FS",e.value="M"+(i+1+3*chart.options.symbols.length),t.add(e);for(i=0;i<chart.options.symbols.length;i++)(e=document.createElement("option")).text=chart.options.symbols[i]+"-FW",e.value="M"+(i+1+4*chart.options.symbols.length),t.add(e);for($("#Select-AxisColor").empty(),t=document.getElementById("Select-AxisColor"),(e=document.createElement("option")).text="Theme",e.value="0",e.style.backgroundColor=window.Highcharts.defaultOptions.yAxis.lineColor,t.add(e),(e=document.createElement("option")).text="1.Serie",e.value="1",e.style.backgroundColor=window.Highcharts.defaultOptions.yAxis.lineColor,t.add(e),i=0;i<chart.options.colors.length;i++)(e=document.createElement("option")).text="Color "+i,e.value=(i+2).toString(),e.style.backgroundColor=chart.options.colors[i],t.add(e);DP_Navigator<4?$(".highcharts-stocktools-wrapper").css("display","block"):$(".highcharts-stocktools-wrapper").css("display","none"),$(window).resize(function(){document.getElementById("container").setAttribute("style","height:"+calcContSize().toString()+"px"),chart.legend.update(defineLegend()),chart.reflow()})}function eventSingleRegister(t,e,i){return(void 0===jQuery._data($(t)[0],"events")||void 0===jQuery._data($(t)[0],"events")[e])&&($(t).on(e,i),!0)}function refreshClick(){Zeitraum_Ende=new Date(Date.now());var t=chart.xAxis[0].getExtremes();return(t.max<t.dataMax||t.min>t.dataMin)&&(DP_Zoom=Math.round((t.max-t.min)/36e5*100)/100),loadNewSerienData(),!0}function setLocalData(t,e){try{var i=H2_server+"_"+H2_port+"_"+H2_version+"_"+t;localStorage.setItem(i,e)}catch{}}function getLocalData(t){try{var e=H2_server+"_"+H2_port+"_"+H2_version+"_"+t;return localStorage.getItem(e)}catch{return""}}function checkZeitraum(t){t=new Date(Zeitraum_Ende-new Date(t._range));return Zeitraum_Start=t,loadNewSerienData(),!(DP_Button_Jump=!0)}function calcContSize(){let t,e;var i=DP_FontSize/14;return t=4===DP_Navigator||3===DP_Navigator?10:55,t=Math.round(t*i),0===DP_ShowFilter?e=0:1===DP_ShowFilter?e=105:2===DP_ShowFilter?e=35:3===DP_ShowFilter&&(e=70),e=Math.round(e*i),$(window).height()-t-e}function ajaxErrorOutput(t,e,i){console.log("AXAJ-error:"),console.log(t),console.log(e),console.log(i)}function sortLowercase(t,e){t=t.toLowerCase(),e=e.toLowerCase();return t<e?-1:e<t?1:0}function clickShowDialogYAxis(t){if(t.classList)for(var e of t.classList)if("axisy"===e.substr(0,5)){showDialogYAxis(e);break}return!0}function toolTipInfo(n){let a=new Date(n.x+getComparisionBackDay(n.series.options.id.split("_")[0])),o="<span style='fill:"+n.color+"'>● </span>"+n.series.name+": <b>"+window.Highcharts.numberFormat(n.y,2,",",".")+" "+n.series.tooltipOptions.valueSuffix+"</b><br/>";if(n.series.hasGroupedData){let t="";var r;n.series.options.id&&(r=DP_attribute.findIndex(t=>t.id===n.series.options.id.toString()),t=0,-1!==r&&(t=parseInt(DP_attribute[r].aggr.substr(1,2))));let e;n.series.currentDataGrouping.totalRange&&(e=n.series.currentDataGrouping.totalRange);let i=window.Highcharts.dateFormat("%H:%M",a.getTime()+e);if("00:00"===i&&(i="24:00"),e<36e5||e<864e5?o+="<b>"+window.Highcharts.dateFormat("%A, %e. %b %Y, %H:%M",a)+"-"+i+"</b>":e<1728e6?o+="<b>"+window.Highcharts.dateFormat("%e. %b",a)+"-"+window.Highcharts.dateFormat("%e. %b %Y",a.getTime()+e-864e5)+"</b>":o+="<b>"+window.Highcharts.dateFormat("%b %Y",a)+"</b>",o+="<i> (<b>",1===t&&(o+=jQuery("<div/>").html("&#x00d8; ").text()),2===t&&(o+=jQuery("<div/>").html("&#x0394; ").text()),3===t&&(o+=jQuery("<div/>").html("&#x03a8; ").text()),4===t&&(o+=jQuery("<div/>").html("&#x01a9; ").text()),5===t&&(o+=jQuery("<div/>").html("&#x01ac; ").text()),6===t&&(o+=jQuery("<div/>").html("&#x2248; ").text()),7===t&&(o+=jQuery("<div/>").html("&#x2359; ").text()),n.series.currentDataGrouping){let t=n.series.currentDataGrouping.unitName+(1<n.series.currentDataGrouping.count?"2":"").toString();window.ChhLanguage.default.historian["aggr"+t]&&(t=window.ChhLanguage.default.historian["aggr"+t]),o+="</b> "+n.series.currentDataGrouping.count+" "+t}o+=")</i><br/>"}else o+="<b>"+window.Highcharts.dateFormat("%A, %b %e, %H:%M:%S",a)+"</b>";return o}function chartSetFontSize(){var t=DP_FontSize.toString()+"px",e=Math.round(DP_FontSize/6*5).toString()+"px",i=Math.round(DP_FontSize/2).toString()+"px",e={title:{style:{fontSize:t}},subtitle:{style:{fontSize:e}},xAxis:{labels:{style:{fontSize:t}},title:{style:{fontSize:t}}},yAxis:{labels:{style:{fontSize:t}},title:{style:{fontSize:t}}},tooltip:{headerFormat:'<span style="font-size: '+t+'">{point.key}</span><br/>',style:{fontSize:e}},legend:{itemStyle:{fontSize:e},navigation:{arrowSize:Math.round(DP_FontSize/6*5),style:{fontSize:e}},title:{style:{fontSize:t}}},credits:{style:{fontSize:i}},labels:{style:{fontSize:e}},rangeSelector:{buttonTheme:{style:{fontSize:e}},buttonSpacing:Math.round(DP_FontSize-7)},navigator:{height:3*DP_FontSize},scrollbar:{height:DP_FontSize},navigation:{buttonOptions:{symbolSize:DP_FontSize,height:DP_FontSize+8,width:DP_FontSize+10},menuItemStyle:{"font-size":e}}};if(DP_Theme_Setting=window.Highcharts.merge(DP_Theme_Setting,e),DP_FontSize){$("body").css("font-size",DP_FontSize.toString()+"px"),$(".form-select-h2").css("font-size",DP_FontSize.toString()+"px"),$(".form-input-h2").css("font-size",DP_FontSize.toString()+"px"),$(".modal-title").css("font-size",DP_FontSize.toString()+"px"),$(".modal-title2").css("font-size",DP_FontSize.toString()+"px"),$(".modal-title3").css("font-size",DP_FontSize.toString()+"px"),$(".btn-default").css("font-size",DP_FontSize.toString()+"px"),$(".LinePopup-text").css("width",140+6*DP_FontSize+"px"),$(".modal-dialog").css("width",400+17*DP_FontSize+"px"),$(".close").css("font-size",(DP_FontSize/2*3).toString()+"px"),$(".navbar-brand").css("font-size",(DP_FontSize+4).toString()+"px"),$(".highcharts-button-box").css("height",(DP_FontSize+4).toString()+"px"),$("#bntFavorit").css("width",16+6*DP_FontSize+"px");let t=document.querySelector("style");t.innerHTML=".highcharts-toggle-toolbar.highcharts-arrow-left  { \n  width: "+(DP_FontSize+6).toString()+"px;\n  height: "+(DP_FontSize+6).toString()+"px;\n  background-color: "+DP_Theme_Setting.background2+";\n}\n.highcharts-toggle-toolbar.highcharts-arrow-left.highcharts-arrow-right {\n  width: "+(DP_FontSize+6).toString()+"px;\n  height: "+(DP_FontSize+6).toString()+"px;\n  background-color: "+DP_Theme_Setting.background2+";\n}\ndiv.highcharts-bindings-wrapper li > span.highcharts-menu-item-btn { \n  background-size: "+(DP_FontSize+20).toString()+"px 100%;\n}\n",t.innerHTML+="div.highcharts-menu-wrapper, div.highcharts-bindings-wrapper ul { \n  width: "+(DP_FontSize+20).toString()+"px;\n}\nli.highcharts-segment > ul.highcharts-submenu-wrapper { \n  width: "+(DP_FontSize+20).toString()+"px;\n  background: "+DP_Theme_Setting.background2+";\n}\ndiv.highcharts-bindings-wrapper .highcharts-stocktools-toolbar li { \n  height: "+(DP_FontSize+20).toString()+"px;\n  background-color: "+DP_Theme_Setting.background2+";\n}\n",t.innerHTML+="div.highcharts-bindings-wrapper .highcharts-stocktools-toolbar li.highcharts-separator {\n  height: "+DP_FontSize.toString()+"px;\n}\n",t.innerHTML+="div#filter select, div#filter input, div#filter button { \n  height: "+(34/14*DP_FontSize).toString()+"px;\n}\n",t.innerHTML+=".highcharts-indicator-list {\n  background: "+DP_Theme_Setting.background2+";\n  color: "+DP_Theme_Setting.textColor+";\n}\n",t.innerHTML+=".highcharts-input-search-indicators-label {\n  color: "+DP_Theme_Setting.textColor+";\n  background: "+DP_Theme_Setting.background2+";\n}\n",t.innerHTML+=".highcharts-popup {\n  background-color: "+DP_Theme_Setting.background2+";\n  color: "+DP_Theme_Setting.textColor+";\n  border: 1px solid "+DP_Theme_Setting.chart.borderColor+";\n}\n",t.innerHTML+="rect.highcharts-button-box {\n  width: "+(DP_FontSize+20).toString()+"px;\n  height: "+(DP_FontSize+10).toString()+"px;\n  x: "+Math.round((DP_FontSize-14)/2*-1).toString()+"px;\n  y: "+Math.round((DP_FontSize-14)/2*-1).toString()+"px;\n}\n",t.innerHTML+=".highcharts-reset-zoom rect.highcharts-button-box {\n  width: "+(DP_FontSize+135).toString()+"px;\n  height: "+(DP_FontSize+20).toString()+"px;\n}\n",t.innerHTML+="div#container{\n  z-index: auto !important;\n  overflow: visible!important;\n}\n"}}$(document).ready(function(){window.Highcharts.setOptions({global:{useUTC:!1},lang:window.ChhLanguage.default.highcharts}),DP_ApiKey="","string"==typeof apiKey&&""!==apiKey&&(DP_ApiKey=apiKey.substring(1,apiKey.length));var t,e,i,n,a,o=getLocalData("setting");if(o&&'{"'===o.substring(0,2))try{DP_settings=JSON.parse(o),parseSetting(),readLinkData();var r=getLocalData("settingTime");(null===r||parseInt(r)+36e5<=Date.now())&&setTimeout(requestSettings,1e3)}catch{requestSettings()}else requestSettings();for(document.getElementById("container").setAttribute("style","height:"+($(document).height()-160)+"px"),document.getElementById("refresh").innerHTML=window.ChhLanguage.default.historian.buttonRefresh,document.getElementById("createLink").innerHTML=window.ChhLanguage.default.historian.buttonLink,document.getElementById("bntFavorit").innerHTML=window.ChhLanguage.default.historian.favoritTxt,document.getElementById("filterFeld").placeholder=window.ChhLanguage.default.historian.filterPlaceHolder,document.title=window.ChhLanguage.default.interface.pageTitle,window.Highcharts.SVGRenderer.prototype.symbols.plus=function(t,e,i,n){return["M",t+.3*i,e,"L",t+.7*i,e,"L",t+.7*i,e+.3*n,"L",t+i,e+.3*n,"L",t+i,e+.7*n,"L",t+.7*i,e+.7*n,"L",t+.7*i,e+n,"L",t+.3*i,e+n,"L",t+.3*i,e+.7*n,"L",t,e+.7*n,"L",t,e+.3*n,"L",t+.3*i,e+.3*n,"L",t+.3*i,e,"Z"]},window.Highcharts.VMLRenderer&&(window.Highcharts.VMLRenderer.prototype.symbols.plus=window.Highcharts.SVGRenderer.prototype.symbols.plus),window.Highcharts.defaultOptions.symbols.push("plus"),window.Highcharts.SVGRenderer.prototype.symbols.cross=function(t,e,i,n){return["M",t,e+.2*n,"L",t+.3*i,e+.5*n,"L",t,e+.8*n,"L",t+.2*i,e+n,"L",t+.5*i,e+.7*n,"L",t+.8*i,e+n,"L",t+i,e+.8*n,"L",t+.7*i,e+.5*n,"L",t+i,e+.2*n,"L",t+.8*i,e,"L",t+.5*i,e+.3*n,"L",t+.2*i,e,"L",t,e+.2*n,"Z"]},window.Highcharts.VMLRenderer&&(window.Highcharts.VMLRenderer.prototype.symbols.cross=window.Highcharts.SVGRenderer.prototype.symbols.cross),window.Highcharts.defaultOptions.symbols.push("cross"),window.Highcharts.SVGRenderer.prototype.symbols.star=function(t,e,i,n){return["M",t,e+.4*n,"L",t+.35*i,e+.35*n,"L",t+.5*i,e,"L",t+.65*i,e+.35*n,"L",t+i,e+.4*n,"L",t+.75*i,e+.65*n,"L",t+.85*i,e+n,"L",t+.5*i,e+.8*n,"L",t+.15*i,e+n,"L",t+.25*i,e+.65*n,"Z"]},window.Highcharts.VMLRenderer&&(window.Highcharts.VMLRenderer.prototype.symbols.star=window.Highcharts.SVGRenderer.prototype.symbols.star),window.Highcharts.defaultOptions.symbols.push("star"),t=document.getElementById("Select-Aggregation"),i=0;i<8;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["aggrtxt"+i],e.value="A"+i,t.add(e);for(t=document.getElementById("Select-AggrTime"),i=0;i<13;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["atimetxt"+i],e.value="T"+i,t.add(e);for(t=document.getElementById("Select-Compare"),i=0;i<14;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["comptype"+i],e.value="C"+i,t.add(e);for(t=document.getElementById("Select-Line"),i=0;i<12;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["linetype"+i],e.value="L"+i,t.add(e);for(t=document.getElementById("Select-DashType"),i=0;i<DP_DashType.length;i++)e=document.createElement("option"),window.ChhLanguage.default.historian["dashtype"+i]?e.text=window.ChhLanguage.default.historian["dashtype"+i]:e.text=DP_DashType[i],e.value="D"+i,t.add(e);for(t=document.getElementById("Select-LineWidth"),i=0;i<11;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["linewidth"+i],e.value="W"+i,t.add(e);for(t=document.getElementById("Select-Legend"),i=0;i<7;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["legendtxt"+i],e.value=i,t.add(e);for(t=document.getElementById("Select-Navigator"),i=0;i<5;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["navitxt"+i],e.value=i,t.add(e);for(t=document.getElementById("Select-Label"),i=0;i<3;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["labeltxt"+i],e.value=i,t.add(e);for(t=document.getElementById("Select-Layout"),i=0;i<4;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["layouttxt"+i],e.value=i,t.add(e);for(t=document.getElementById("Select-Grid"),i=0;i<7;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["gridtxt"+i],e.value=i,t.add(e);for(t=document.getElementById("Select-Content"),i=0;i<4;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["contenttxt"+i],e.value=i,t.add(e);for(t=document.getElementById("Select-DataPoint"),i=0;i<4;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["datapoint"+i],e.value=i,t.add(e);for(n in t=document.getElementById("Select-Theme"),(e=document.createElement("option")).text="Standard hell/dunkel",e.value="standard",t.add(e),window.DP_Themes)(e=document.createElement("option")).text=n,e.value=n,t.add(e);for(n in t=document.getElementById("Select-FontSize"),window.DP_FontSizes)(e=document.createElement("option")).text=window.ChhLanguage.default.historian.fontsize+"-"+DP_FontSizes[n].toString(),e.value=DP_FontSizes[n],t.add(e);for(t=document.getElementById("Select-AxisType"),(e=document.createElement("option")).text=window.ChhLanguage.default.historian.yaxistype0,e.value="0",t.add(e),(e=document.createElement("option")).text=window.ChhLanguage.default.historian.yaxistype1,e.value="1",t.add(e),t=document.getElementById("Select-Position"),(e=document.createElement("option")).text=window.ChhLanguage.default.historian.yaxispos0,e.value="0",t.add(e),(e=document.createElement("option")).text=window.ChhLanguage.default.historian.yaxispos1,e.value="1",t.add(e),t=document.getElementById("Select-Limit"),(e=document.createElement("option")).text=window.ChhLanguage.default.historian.yaxislimit0,e.value="0",t.add(e),(e=document.createElement("option")).text=window.ChhLanguage.default.historian.yaxislimit1,e.value="1",t.add(e),(e=document.createElement("option")).text=window.ChhLanguage.default.historian.yaxislimit2,e.value="2",t.add(e),t=document.getElementById("Select-Stacking"),i=0;i<6;i++)(e=document.createElement("option")).text=window.ChhLanguage.default.historian["Stacking"+i],e.value=i,t.add(e);(a=window.Highcharts).wrap(a.Legend.prototype,"render",function(t){let e=this,i=a.pick(e.options.navigation.animation,!0);t.apply(this,Array.prototype.slice.call(arguments,1)),$(e.group.element).on("wheel",function(t){Scroll_Legend&&(e.chart.pointer.normalize(t).originalEvent.deltaY<0?e.scroll(-1,i):e.scroll(1,i)),Scroll_Legend=!Scroll_Legend})}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{"standard"===DP_Theme&&createChart()}),setStockToolLang()}),$("#DialogBtnOK").click(function(){return getDialogLine(),!0}),$("#LineDefault").click(function(){return saveLine(),!0}),$("#DialogBtnClose").click(function(){return $("#LinePopup").modal("hide"),!0}),$("#Dialog2BtnOK").click(function(){return getDialogSetting(),!0}),$("#SettingDefault").click(function(){return saveSetting(),!0}),$("#Dialog4BtnOK").click(function(){return $("#FavPopup").modal("hide"),!(document.getElementById("Line-Title4").value="")}),$("#favAdd").click(function(){return getDialogFav(),!(document.getElementById("Line-Title4").value="")}),$("#Dialog4BtnClose").click(function(){return document.getElementById("Line-Title4").value="",$("#FavPopup").modal("hide"),!0}),$("#Dialog2BtnClose").click(function(){$("#SettingPopup").modal("hide")}),$("#Dialog3BtnOK").click(function(){return getDialogAxis(),!0}),$("#AxisDefault").click(function(){getDialogAxis();var t="";return t+="P"+(DP_yAxis[DP_PopupAxisPos].position?"1":"0"),t+="|C"+DP_yAxis[DP_PopupAxisPos].type,t+="|A"+DP_yAxis[DP_PopupAxisPos].limit,t+="|L"+DP_yAxis[DP_PopupAxisPos].min,t+="|H"+DP_yAxis[DP_PopupAxisPos].max,t+="|G"+DP_yAxis[DP_PopupAxisPos].tick,t+="|F"+DP_yAxis[DP_PopupAxisPos].color,t+="|T"+encodeURIComponent(DP_yAxis[DP_PopupAxisPos].text).replace(/'/g,"%27"),DP_settings["YAXIS"+DP_PopupAxisPos]=t,saveSettingsH2(),!0}),$("#Dialog3BtnClose").click(function(){return $("#AxisPopup").modal("hide"),!0}),eventSingleRegister("#filterFeld","keyup",function(){filter_feld=$(this).val().toLowerCase(),changeEventRaumFilter()}),eventSingleRegister("#Select-Raum","change",function(){changeEventRaumFilter()}),eventSingleRegister("#Select-Gewerk","change",function(){changeEventRaumFilter()}),eventSingleRegister("#refresh","click",function(){return refreshClick(),!0}),eventSingleRegister("#createLink","click",function(){return createUrl(),!0}),eventSingleRegister("#bntFavorit","click",function(){return showDialogFav(),!0}),eventSingleRegister("#Select-Color","change",function(){document.getElementById("Select-Color").style.backgroundColor=chart.options.colors[parseInt(document.getElementById("Select-Color").value.substr(1,2))]}),eventSingleRegister("#Select-AxisColor","change",function(){showDialogYAxisUpdatColor()});
//# sourceMappingURL=H2-HighChart.js.map